(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[626],{2015:function(e,n,t){var s={"./firebase-authentication.md":330,"./firebase-checkout-session-connect.md":2533,"./firebase-create-connect-account.md":5917,"./firebase-create-customer.md":9605,"./firebase-create-firestore.md":9170,"./firebase-create-project.md":5977,"./firebase-create-web-app.md":6668,"./firebase-express-dashboard.md":1014,"./firebase-initialize.md":6646,"./firebase-install-stripe-extension.md":3047,"./firebase-install-stripe.md":2108,"./firebase-rebuild-extension.md":9163,"./firebase-required-verification-information.md":7434,"./firebase-security-rule.md":7445,"./nextjs-auth-connect.md":3439,"./nextjs-auth.md":1879,"./nextjs-checkout-billing.md":555,"./nextjs-checkout-connect.md":6344,"./nextjs-checkout-payments.md":9712,"./nextjs-create-connect-account.md":4742,"./nextjs-customer-portal-open.md":8931,"./nextjs-display-role.md":5400,"./nextjs-express-dashboard.md":6809,"./nextjs-firebase-initialize.md":8542,"./nextjs-list-items-billing.md":8062,"./nextjs-list-items-connect.md":3476,"./nextjs-list-items.md":7186,"./nextjs-purchase-history.md":8992,"./nextjs-required-verification-information.md":514,"./nextjs-setup.md":6470,"./stripe-connect-account-webhook.md":2994,"./stripe-connect-settings.md":7415,"./stripe-create-account.md":9613,"./stripe-create-api-key.md":9754,"./stripe-create-products-billing.md":7337,"./stripe-create-products.md":1251,"./stripe-create-tax.md":2328,"./stripe-create-webhook.md":1018,"./stripe-customer-portal-customize-billing.md":2487,"./stripe-customer-portal-customize.md":1804};function r(e){var n=i(e);return t(n)}function i(e){if(!t.o(s,e)){var n=new Error("Cannot find module '"+e+"'");throw n.code="MODULE_NOT_FOUND",n}return s[e]}r.keys=function(){return Object.keys(s)},r.resolve=i,e.exports=r,r.id=2015},5733:function(e,n,t){"use strict";var s=t(5893),r=t(3801),i=t(1664);n.Z=function(e){var n=e.href,t=e.children;return(null===n||void 0===n?void 0:n.match("^http"))?(0,s.jsxs)("a",{href:n,rel:"noreferrer",className:"text-indigo-600",target:"_blank",children:[(0,s.jsx)("span",{children:t}),(0,s.jsx)(r.h0n,{className:"inline-block w-3 h-3 text-indigo-400 align-top"})]}):(0,s.jsx)(i.default,{href:n,children:(0,s.jsx)("a",{className:"text-indigo-600",children:t})})}},9626:function(e,n,t){"use strict";t.d(n,{Z:function(){return G}});var s=t(5893),r=t(1163),i=t(7294),o=function(){var e;return(null===(e=localStorage.getItem("complete"))||void 0===e?void 0:e.split(","))||[]},a=["stripe","nextjs","firebase"],c={payments:[{title:"\u74b0\u5883\u69cb\u7bc9",tool:{stripe:["stripe-create-account","stripe-create-api-key","stripe-create-webhook"],nextjs:["nextjs-setup","nextjs-firebase-initialize"],firebase:["firebase-create-project","firebase-create-web-app","firebase-create-firestore","firebase-authentication","firebase-install-stripe-extension","firebase-security-rule","firebase-rebuild-extension"]}},{title:"\u5546\u54c1\u306e\u4f5c\u6210\u3068\u8868\u793a",tool:{stripe:["stripe-create-products","stripe-create-tax"],nextjs:["nextjs-auth","nextjs-list-items"]}},{title:"\u5546\u54c1\u306e\u8cfc\u5165",tool:{nextjs:["nextjs-checkout-payments"]}},{title:"\u8cfc\u5165\u3057\u305f\u5546\u54c1\u306e\u8868\u793a",tool:{nextjs:["nextjs-purchase-history"]}},{title:"\u652f\u6255\u3044\u65b9\u6cd5\u306e\u7ba1\u7406",tool:{stripe:["stripe-customer-portal-customize"],nextjs:["nextjs-customer-portal-open"]}}],billing:[{title:"\u74b0\u5883\u69cb\u7bc9",tool:{stripe:["stripe-create-account","stripe-create-api-key","stripe-create-webhook"],nextjs:["nextjs-setup","nextjs-firebase-initialize"],firebase:["firebase-create-project","firebase-create-web-app","firebase-create-firestore","firebase-authentication","firebase-install-stripe-extension","firebase-security-rule","firebase-rebuild-extension"]}},{title:"\u5546\u54c1\u306e\u4f5c\u6210\u3068\u8868\u793a",tool:{stripe:["stripe-create-products-billing","stripe-create-tax"],nextjs:["nextjs-auth","nextjs-list-items-billing"]}},{title:"\u30b5\u30d6\u30b9\u30af\u30ea\u30d7\u30b7\u30e7\u30f3\u306e\u958b\u59cb",tool:{nextjs:["nextjs-checkout-billing"]}},{title:"\u5951\u7d04\u72b6\u614b\u306e\u78ba\u8a8d",tool:{nextjs:["nextjs-display-role"]}},{title:"\u652f\u6255\u3044\u65b9\u6cd5\u306e\u7ba1\u7406",tool:{stripe:["stripe-customer-portal-customize-billing"],nextjs:["nextjs-customer-portal-open"]}}],connect:[{title:"\u74b0\u5883\u69cb\u7bc9",tool:{stripe:["stripe-create-account","stripe-create-api-key","stripe-create-webhook"],nextjs:["nextjs-setup","nextjs-firebase-initialize"],firebase:["firebase-create-project","firebase-create-web-app","firebase-create-firestore","firebase-authentication","firebase-initialize","firebase-install-stripe"]}},{title:"\u30ab\u30b9\u30bf\u30de\u30fc\u306e\u4f5c\u6210",tool:{nextjs:["nextjs-auth-connect"],firebase:["firebase-create-customer"]}},{title:"Connect\u30a2\u30ab\u30a6\u30f3\u30c8\u306e\u4f5c\u6210",tool:{stripe:["stripe-connect-settings","stripe-connect-account-webhook"],nextjs:["nextjs-create-connect-account","nextjs-required-verification-information"],firebase:["firebase-create-connect-account","firebase-required-verification-information"]}},{title:"\u5546\u54c1\u306e\u4f5c\u6210\u3068\u8868\u793a",tool:{stripe:["stripe-create-products","stripe-create-tax"],nextjs:["nextjs-list-items-connect"]}},{title:"\u5546\u54c1\u306e\u8cfc\u5165",tool:{nextjs:["nextjs-checkout-connect"],firebase:["firebase-checkout-session-connect"]}},{title:"\u30c0\u30c3\u30b7\u30e5\u30dc\u30fc\u30c9\u306e\u8868\u793a",tool:{nextjs:["nextjs-express-dashboard"],firebase:["firebase-express-dashboard"]}}]},u=t(192),l=t(1984),p=t(8412),d=t(1664),m=t(3801),f=t(5307),h={"firebase-authentication":"Firebase Authentication \u306e\u6709\u52b9\u5316","firebase-create-firestore":"Cloud Firestore \u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u3092\u4f5c\u6210","firebase-create-project":"Firebase\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3092\u4f5c\u6210","firebase-install-stripe":"Stripe Node.js Library \u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb","firebase-initialize":"Firebase\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306e\u521d\u671f\u5316","firebase-create-connect-account":"Connect\u30a2\u30ab\u30a6\u30f3\u30c8\u4f5c\u6210\u95a2\u6570\u3092\u4f5c\u6210","firebase-rebuild-extension":"\u7f72\u540d\u30b7\u30fc\u30af\u30ec\u30c3\u30c8\u306e\u8a2d\u5b9a","firebase-security-rule":"Cloud Firestore \u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u30eb\u30fc\u30eb\u3092\u8a2d\u5b9a","firebase-install-stripe-extension":"Run Payments with Stripe \u62e1\u5f35\u6a5f\u80fd\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb","nextjs-list-items":"\u5546\u54c1\u4e00\u89a7\u306e\u8868\u793a","nextjs-setup":"\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3092\u4f5c\u6210","stripe-create-account":"\u30a2\u30ab\u30a6\u30f3\u30c8\u3092\u4f5c\u6210","stripe-create-api-key":"\u5236\u9650\u4ed8\u304dAPI\u30ad\u30fc\u3092\u4f5c\u6210","stripe-create-products":"\u5546\u54c1\u3068\u4fa1\u683c\u3092\u4f5c\u6210","stripe-create-tax":"\u7a0e\u7387\u3092\u4f5c\u6210","stripe-create-webhook":"Webhook\u3092\u4f5c\u6210","stripe-customer-portal-customize":"\u30ab\u30b9\u30bf\u30de\u30fc\u30dd\u30fc\u30bf\u30eb\u306e\u8a2d\u5b9a","nextjs-customer-portal-open":"\u30ab\u30b9\u30bf\u30de\u30fc\u30dd\u30fc\u30bf\u30eb\u3092\u958b\u304f","nextjs-checkout-payments":"\u652f\u6255\u3044\u3092\u958b\u59cb","nextjs-checkout-connect":"\u5546\u54c1\u306e\u8cfc\u5165","nextjs-firebase-initialize":"Firebase\u306e\u521d\u671f\u5316","firebase-create-web-app":"\u30a2\u30d7\u30ea\u306e\u767b\u9332","nextjs-purchase-history":"\u8cfc\u5165\u5c65\u6b74\u306e\u8868\u793a","nextjs-express-dashboard":"\u30c0\u30c3\u30b7\u30e5\u30dc\u30fc\u30c9\u306e\u8868\u793a","firebase-express-dashboard":"\u30c0\u30c3\u30b7\u30e5\u30dc\u30fc\u30c9\u30ea\u30f3\u30af\u751f\u6210","firebase-checkout-session-connect":"\u30c1\u30a7\u30c3\u30af\u30a2\u30a6\u30c8\u30bb\u30c3\u30b7\u30e7\u30f3\u306e\u4f5c\u6210","nextjs-auth":"\u30ed\u30b0\u30a4\u30f3/\u30ed\u30b0\u30a2\u30a6\u30c8\u306e\u5b9f\u88c5","stripe-create-products-billing":"\u5546\u54c1\u3068\u4fa1\u683c\u3092\u4f5c\u6210","nextjs-list-items-billing":"\u30d7\u30e9\u30f3\u4e00\u89a7\u306e\u8868\u793a","nextjs-checkout-billing":"\u30d7\u30e9\u30f3\u306e\u8cfc\u5165","nextjs-display-role":"\u6a29\u9650\u306e\u8868\u793a","stripe-customer-portal-customize-billing":"\u30ab\u30b9\u30bf\u30de\u30fc\u30dd\u30fc\u30bf\u30eb\u306e\u8a2d\u5b9a","nextjs-create-connect-account":"Connect\u30a2\u30ab\u30a6\u30f3\u30c8\u306e\u4f5c\u6210\u95a2\u6570\u306e\u5b9f\u884c","stripe-connect-settings":"Connect\u306e\u8a2d\u5b9a","firebase-create-customer":"\u30ab\u30b9\u30bf\u30de\u30fc\u4f5c\u6210\u30c8\u30ea\u30ac\u30fc\u306e\u5b9f\u88c5","nextjs-auth-connect":"\u30ed\u30b0\u30a4\u30f3\u6a5f\u80fd\u306e\u5b9f\u88c5","nextjs-required-verification-information":"\u78ba\u8a8d\u60c5\u5831\u306e\u5165\u529b","stripe-connect-account-webhook":"Stripe Connect\u7528Webhook\u306e\u4f5c\u6210","nextjs-list-items-connect":"\u5546\u54c1\u306e\u8868\u793a","firebase-required-verification-information":"\u78ba\u8a8d\u60c5\u5831\u5165\u529b\u7528\u30ea\u30f3\u30af\u3068\u30c8\u30ea\u30ac\u30fc\u95a2\u6570\u3092\u4f5c\u6210"},b=function(e){return h[e]},x=function(e){var n=e.title,t=e.TabIcon;return(0,s.jsxs)("div",{className:"px-4 justify-center flex items-center space-x-2 text-center",children:[(0,s.jsx)(t,{size:24,className:"text-gray-500"}),(0,s.jsx)("span",{className:"block text-gray-600",children:n})]})},g=function(e){var n=e.type,t=e.completeDocs;return(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"grid grid-cols-4 gap-2 sticky z-10 top-0 py-4 border-b dark:border-gray-700 bg-white dark:bg-slate-800",children:[(0,s.jsx)("div",{}),(0,s.jsx)(x,{TabIcon:u.Z,title:"Stripe"}),(0,s.jsx)(x,{TabIcon:l.Z,title:"Next.js"}),(0,s.jsx)(x,{TabIcon:p.Z,title:"Firebase"})]}),(0,s.jsx)("div",{className:"divide-dashed divide-y dark:divide-gray-700",children:c[n].map((function(e,n){return(0,s.jsxs)("div",{className:"grid grid-cols-4 gap-2 py-6",children:[(0,s.jsxs)("h2",{children:[(0,s.jsxs)("span",{className:"text-gray-500 dark:text-gray-700 font-bold",children:["STEP ",n+1]}),(0,s.jsx)("span",{className:"font-bold text-gray-700 dark:text-gray-500 text-lg block",children:e.title})]}),a.map((function(n){var r;return(0,s.jsx)("div",{className:"space-y-2",children:null===(r=e.tool[n])||void 0===r?void 0:r.map((function(e){return(0,s.jsx)(d.default,{shallow:!0,href:"?id=".concat(e),children:(0,s.jsxs)("a",{className:"flex items-center text-gray-600 dark:text-gray-300 hover:text-gray-800 hover:dark:text-gray-200 text-left space-x-2 w-full",children:[(0,s.jsx)(m.rE2,{className:(0,f.A)("w-6 h-6",(null===t||void 0===t?void 0:t.includes(e))?"text-lime-500":"opacity-10")}),(0,s.jsx)("span",{className:"text-sm",children:b(e)})]})},e)}))},n)}))]},n)}))})]})},y=function(e){var n=e.type,t=e.completeDocs;return(0,s.jsx)("div",{className:"divide-y divide-dashed",children:c[n].map((function(e,n){return(0,s.jsx)(j,{completeDocs:t,index:n,step:e},n)}))})},j=function(e){var n=e.step,t=e.index,i=e.completeDocs,o=Object.keys(n.tool),a=(0,r.useRouter)(),c={firebase:p.Z,stripe:u.Z,nextjs:l.Z},h={firebase:"Firebase",stripe:"Stripe",nextjs:"Next.js"};return(0,s.jsxs)("div",{className:"py-8",children:[(0,s.jsxs)("h2",{className:"font-bold mb-2",children:[(0,s.jsxs)("span",{className:"block text-sm opacity-40",children:["STEP ",t+1]}),(0,s.jsx)("span",{className:"opacity-70",children:n.title})]}),(0,s.jsx)("div",{className:"space-y-3",children:o.map((function(e){var t,r=c[e];return(0,s.jsxs)("div",{className:"ml-2",children:[(0,s.jsxs)("h3",{className:"flex items-center space-x-1 font-medium opacity-40",children:[(0,s.jsx)(r,{size:16,className:"text-gray-500"}),(0,s.jsx)("span",{children:h[e]})]}),(0,s.jsx)("ul",{children:null===(t=n.tool[e])||void 0===t?void 0:t.map((function(e){return(0,s.jsx)("li",{children:(0,s.jsx)(d.default,{shallow:!0,href:{pathname:a.pathname,query:{id:e}},children:(0,s.jsxs)("a",{className:"py-1 flex items-center space-x-1 opacity-60",children:[(0,s.jsx)(m.rE2,{className:(0,f.A)("w-5 h-5",(null===i||void 0===i?void 0:i.includes(e))?"text-lime-500":"opacity-10")}),(0,s.jsx)("span",{children:b(e)})]})})},e)}))})]},e)}))})]})},v=t(5131),w=t(9670),k=t(5690),S=t(4855),E=t(9259),C=t(7988),P=t(6366),N=t(3018),A=t(6032),_=t(1356),R=t(9925),L=t(5733),F=t(5046),I=t(8570),U=t(4354),D=t(7757),T=t(3153),q=function(e){var n=e.node.tagName,t=e.children,r={info:T.AV5,warning:T.SI8,important:T.$Ow}[n],i={info:{bg:"bg-blue-50",icon:"text-blue-400",text:"text-blue-700"},warning:{bg:"bg-yellow-50",icon:"text-yellow-400",text:"text-yellow-700"},important:{bg:"bg-red-50",icon:"text-red-400",text:"text-red-700"}}[n];return(0,s.jsx)("div",{className:"rounded-md not-prose p-4 ".concat(i.bg),children:(0,s.jsxs)("div",{className:"flex",children:[(0,s.jsx)("div",{className:"flex-shrink-0",children:(0,s.jsx)(r,{className:"h-5 w-5 ".concat(i.icon),"aria-hidden":"true"})}),(0,s.jsx)("div",{className:"ml-3 flex-1 text-sm ".concat(i.text),children:t})]})})};function O(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function B(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{},s=Object.keys(t);"function"===typeof Object.getOwnPropertySymbols&&(s=s.concat(Object.getOwnPropertySymbols(t).filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})))),s.forEach((function(n){O(e,n,t[n])}))}return e}function z(e,n){if(null==e)return{};var t,s,r=function(e,n){if(null==e)return{};var t,s,r={},i=Object.keys(e);for(s=0;s<i.length;s++)t=i[s],n.indexOf(t)>=0||(r[t]=e[t]);return r}(e,n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)t=i[s],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(r[t]=e[t])}return r}N.Z.registerLanguage("tsx",F.Z),N.Z.registerLanguage("ts",I.Z),N.Z.registerLanguage("bash",U.Z),N.Z.registerLanguage("diff",D.Z);var Z=function(e){var n,t=e.data;return(0,s.jsx)(E.D,{remarkPlugins:[_.Z,R.Z,C.Z,P.Z],className:"prose prose-pre:p-0 dark:prose-invert",transformImageUri:function(e){return"/stripe-doc"+e},components:(n={a:function(e){var n=e.href,t=e.children;return(0,s.jsx)(L.Z,{href:n,children:t})},pre:function(e){var n=e.children;return(0,s.jsx)("pre",{className:"first:mt-0 last:mb-0 overflow-hidden shadow",children:n})}},O(n,"info",q),O(n,"warning",q),O(n,"important",q),O(n,"img",(function(e){var n=e.src;return(0,s.jsx)("a",{href:n,target:"_blank",rel:"noreferrer",children:(0,s.jsx)("img",{src:n,className:"rounded-md shadow overflow-hidden block",alt:""})})})),O(n,"code",(function(e){e.node;var n,t=e.inline,r=e.className,i=e.children,o=z(e,["node","inline","className","children"]),a=/language-(\w+)/.exec(r||""),c=null===(n=null===r||void 0===r?void 0:r.split(":"))||void 0===n?void 0:n[1];return!t&&a?(0,s.jsxs)("div",{children:[c&&(0,s.jsxs)("div",{className:"bg-[#1f192c] border-b flex items-center justify-between border-black text-sm py-2 px-3 text-white",children:[(0,s.jsx)("span",{className:"opacity-60",children:c}),(0,s.jsx)(S.CopyToClipboard,{onCopy:function(){return k.ZP.success("\u30b3\u30d4\u30fc\u3057\u307e\u3057\u305f",{position:"bottom-center"})},text:String(i),children:(0,s.jsx)("button",{children:(0,s.jsx)(m.Kmg,{className:"w-6 h-6 text-gray-500"})})})]}),(0,s.jsx)(N.Z,B({style:A.Z,language:a[1],PreTag:"div",customStyle:{margin:0}},o,{children:String(i).replace(/\n$/,"")}))]}):(0,s.jsx)("code",B({},o,{children:i}))})),n),children:t})},H=function(e){var n=e.id;try{var r,i=null===(r=t(2015)("./".concat(n,".md")))||void 0===r?void 0:r.default;return(0,s.jsx)("div",{children:(0,s.jsx)(Z,{data:i})})}catch(o){return null}},W=function(e){var n=e.id,t=(0,i.useRef)(null);(0,i.useEffect)((function(){if(t.current){var e=localStorage.getItem("playbackRate");t.current.defaultPlaybackRate=e?Number(e):2}}),[t.current]),(0,i.useEffect)((function(){t.current&&t.current.load()}),[n]);var r="/stripe-doc/docs/videos/"+n+".mp4";return(0,s.jsx)("video",{ref:t,loop:!0,autoPlay:!0,controlsList:"nodownload",controls:!0,className:"aspect-video bg-slate-800 w-full",onRateChange:function(e){var n=e.target.playbackRate;localStorage.setItem("playbackRate",String(n))},children:(0,s.jsx)("source",{src:r})})};function $(e){var n=e.isOpen,t=e.onClose,r=e.id,a=e.onComplete,c=(0,i.useState)(),u=c[0],l=c[1],p=(0,i.useRef)(null);(0,i.useEffect)((function(){r&&l(r)}),[r]);var d,f=function(e,n){return"https://github.com/flock-team/stripe-doc/".concat(n,"/main/docs/").concat(e,".md")};return(0,s.jsx)(v.u.Root,{show:n,as:i.Fragment,children:(0,s.jsx)(w.V,{as:"div",className:"fixed z-10 inset-0 overflow-y-auto",initialFocus:p,onClose:t,children:(0,s.jsxs)(w.V.Overlay,{as:"div",className:"flex items-end justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0",children:[(0,s.jsx)(v.u.Child,{as:i.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:(0,s.jsx)("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity pointer-events-none"})}),(0,s.jsx)("span",{className:"hidden sm:inline-block sm:align-middle sm:h-screen","aria-hidden":"true",children:"\u200b"}),u&&(0,s.jsx)(v.u.Child,{as:i.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95",enterTo:"opacity-100 translate-y-0 sm:scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 translate-y-0 sm:scale-100",leaveTo:"opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95",children:(0,s.jsxs)("div",{className:"inline-block align-bottom bg-white dark:bg-slate-800 rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full",children:[(0,s.jsx)(W,{id:u}),(0,s.jsxs)("div",{className:"px-4 pt-5 pb-4 sm:p-6",children:[(0,s.jsx)(w.V.Title,{as:"h3",className:"text-lg text-center leading-6 font-medium text-gray-900 dark:text-gray-400",children:b(u)}),(0,s.jsx)("div",{className:"mt-3",children:(0,s.jsx)(H,{id:u})}),(0,s.jsxs)("div",{className:"mt-5 sm:mt-6 sm:grid sm:grid-cols-2 sm:gap-3 sm:grid-flow-row-dense",children:[(d=u,o().includes(d)?(0,s.jsx)("button",{type:"button",className:"w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-gray-600 text-base font-medium text-white hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500 sm:col-start-2 sm:text-sm",onClick:function(){if(r){var e=function(e){var n=o().filter((function(n){return n!==e}));return localStorage.setItem("complete",n.join(",")),n}(r);a(e)}},ref:p,children:"\u672a\u5b8c\u4e86\u306b\u3059\u308b"}):(0,s.jsx)("button",{type:"button",className:"w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-indigo-600 text-base font-medium text-white hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 sm:col-start-2 sm:text-sm",onClick:function(){if(r){var e=function(e){var n=o();n.push(e);var t=Array.from(new Set(n));return localStorage.setItem("complete",t.join(",")),t}(r);k.ZP.success("\u5b8c\u4e86\u3057\u307e\u3057\u305f",{position:"bottom-center"}),a(e)}},ref:p,children:"\u5b8c\u4e86"})),(0,s.jsx)("button",{type:"button",className:"mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white dark:bg-slate-700 dark:border-gray-900 dark:text-gray-400 text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 sm:mt-0 sm:col-start-1 sm:text-sm",onClick:t,children:"\u9589\u3058\u308b"})]}),(0,s.jsxs)("div",{className:"items-center space-x-4 justify-end flex mt-4 text-gray-400 text-sm",children:[(0,s.jsxs)("a",{href:encodeURI("https://github.com/flock-team/stripe-doc/issues/new?body=## \u8a72\u5f53\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\n".concat(f(u,"blob"),"\n\n## \u5831\u544a\u5185\u5bb9\n&title=\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u5831\u544a: ").concat(r)).replace(/#/g,"%23"),target:"_blank",className:"flex items-center space-x-2 hover:text-gray-700",rel:"noreferrer",children:[(0,s.jsx)(m.U65,{className:"w-4 h-4 inline"}),(0,s.jsx)("span",{children:"\u5831\u544a"})]}),(0,s.jsxs)("a",{href:f(u,"edit"),target:"_blank",className:"flex items-center space-x-2 hover:text-gray-700",rel:"noreferrer",children:[(0,s.jsx)(m.vdY,{className:"w-4 h-4 inline"}),(0,s.jsx)("span",{children:"\u7de8\u96c6"})]})]})]})]})})]})})})}var G=function(e){var n=e.title,t=e.description,a=e.scenes,c=e.type,u=e.demo,l=(0,i.useState)(),p=l[0],d=l[1],m=(0,r.useRouter)(),f=m.query.id,h=function(e){m.push({pathname:m.pathname,query:e?{id:e}:{}},void 0,{shallow:!0})};(0,i.useEffect)((function(){d(o())}),[]);var b="/stripe-doc/docs/videos/"+c+".mp4";return(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"bg-gray-50 dark:bg-slate-900 shadow-sm",children:(0,s.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,s.jsxs)("div",{className:"py-10 lg:flex items-center",children:[(0,s.jsx)("video",{loop:!0,autoPlay:!0,controlsList:"nodownload",controls:!0,className:"aspect-video bg-slate-800 rounded-lg lg:w-96 lg:mr-10 mb-6 lg:mb-0 shadow-lg hover:shadow-xl transition-shadow",children:(0,s.jsx)("source",{src:b})}),(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("h1",{className:"text-2xl mb-4 leading-6 font-semibold text-gray-800 dark:text-gray-400",children:n}),(0,s.jsx)("div",{className:"text-gray-500 mb-6",children:t}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h2",{className:"text-gray-700 dark:text-gray-600 font-bold mb-2",children:"\u5229\u7528\u30b7\u30fc\u30f3"}),(0,s.jsx)("p",{className:"text-gray-500",children:a.join(" / ")})]})]})]})})}),(0,s.jsxs)("div",{className:"max-w-7xl mx-auto py-6 px-4 sm:px-6 lg:px-8",children:[(0,s.jsxs)("div",{className:"mt-6 mb-10 max-w-3xl",children:[(0,s.jsx)("h2",{className:"font-bold text-2xl mb-4 opacity-70",children:u.title}),(0,s.jsx)("p",{className:"opacity-60 leading-relaxed",children:u.description}),(0,s.jsx)("button",{className:"text-gray-400 dark:text-gray-700 mt-4",onClick:function(){d((localStorage.removeItem("complete"),[]))},children:"\u5b8c\u4e86\u72b6\u614b\u3092\u30ea\u30bb\u30c3\u30c8\u3059\u308b"})]}),(0,s.jsxs)("div",{className:"mb-20",children:[(0,s.jsx)("div",{className:"lg:block hidden",children:(0,s.jsx)(g,{type:c,completeDocs:p})}),(0,s.jsx)("div",{className:"block lg:hidden",children:(0,s.jsx)(y,{type:c,completeDocs:p})})]})]})]}),(0,s.jsx)($,{isOpen:Boolean(f),onClose:function(){return h()},onComplete:function(e){h(),d(e)},id:f})]})}},330:function(e,n,t){"use strict";t.r(n),n.default="[Google \u30ed\u30b0\u30a4\u30f3\u3092\u6709\u52b9](https://firebase.google.com/docs/auth/web/google-signin?hl=ja)\u306b\u3057\u3066\u304f\u3060\u3055\u3044\u3002\u4ed6\u306e\u30ed\u30b0\u30a4\u30f3\u65b9\u6cd5\u3092\u9078\u3076\u3053\u3068\u3082\u3067\u304d\u307e\u3059\u3002\n\nGoogle\u4ee5\u5916\u306e\u5916\u90e8\u30a2\u30ab\u30a6\u30f3\u30c8\u9023\u643a\u30ed\u30b0\u30a4\u30f3\u306f\u5916\u90e8\u30b5\u30fc\u30d3\u30b9\u306e\u8a2d\u5b9a\u3082\u5fc5\u8981\u306b\u306a\u308b\u305f\u3081Stripe\u306e\u5b9f\u88c5\u3092\u8a66\u3059\u4e0a\u3067\u306f\u304a\u52e7\u3081\u3057\u307e\u305b\u3093\u3002\u305d\u306e\u4e0a\u3067\u5b9f\u88c5\u65b9\u6cd5\u306b\u8208\u5473\u304c\u3042\u308b\u65b9\u306f\u516c\u5f0f\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u3092\u53c2\u7167\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\n- [Twitter](https://firebase.google.com/docs/auth/web/twitter-login?hl=ja)\n- [GitHub](https://firebase.google.com/docs/auth/web/github-auth?hl=ja)\n- [Facebook](https://firebase.google.com/docs/auth/web/facebook-login?hl=ja)\n"},2533:function(e,n,t){"use strict";t.r(n),n.default='\u4ee5\u4e0b\u306e\u30b3\u30fc\u30c9\u3092\u8ffd\u52a0\u3057\u3066\u30c1\u30a7\u30c3\u30af\u30a2\u30a6\u30c8\u30bb\u30c3\u30b7\u30e7\u30f3\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n\n```tsx:functions/index.tsx \nexport const createCheckoutSession = fns.https.onCall(async (_, context) => {\n  if (!context.auth) {\n    throw new functions.https.HttpsError("unauthenticated", "\u30ed\u30b0\u30a4\u30f3\u304c\u5fc5\u8981\u3067\u3059");\n  }\n\n  const customerSnap = await db.doc(`customers/${context.auth.uid}`).get();\n  const customer = customerSnap.data()?.stripeId as string;\n\n  const accountSnap = await db.doc(`stripeAccounts/${context.auth.uid}`).get();\n  const account = accountSnap.data()?.stripeAccountId as string;\n\n  const session = await stripe.checkout.sessions.create({\n    mode: "payment",\n    customer,\n    line_items: [\n      {\n        price: "price_1KLKQPHKPHgsaXXhIwTCqN8N",\n        tax_rates: ["txr_1KLKRBHKPHgsaXXh3RsYP1bW"],\n        quantity: 1,\n      },\n    ],\n    cancel_url: "http://localhost:3000",\n    success_url: "http://localhost:3000",\n    payment_intent_data: {\n      setup_future_usage: "off_session",\n      application_fee_amount: 300,\n      transfer_data: {\n        destination: account,\n      },\n    },\n  });\n\n  return session.url;\n});\n```\n\n[Stripe \u306e\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8: \u652f\u6255\u3044\u3092\u53d7\u3051\u4ed8\u3051\u308b](https://stripe.com/docs/payments/accept-a-payment?integration=checkout)'},5917:function(e,n,t){"use strict";t.r(n),n.default='\u4ee5\u4e0b\u306e\u30b3\u30fc\u30c9\u3092\u8ffd\u8a18\u3057\u3066\u30c7\u30d7\u30ed\u30a4\u3057\u3066\u304f\u3060\u3055\u3044\u3002WEB\u30a2\u30d7\u30ea\u304b\u3089\u4ee5\u4e0b\u306e\u95a2\u6570\u3092\u5b9f\u884c\u3059\u308b\u3068\u8ca9\u58f2\u30a2\u30ab\u30a6\u30f3\u30c8\u3092\u4f5c\u6210\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\n```ts\nexport const createStripeAccount = fns.https.onCall(async (_, context) => {\n  if (!context.auth) {\n    throw new functions.https.HttpsError("unauthenticated", "\u30ed\u30b0\u30a4\u30f3\u304c\u5fc5\u8981\u3067\u3059");\n  }\n\n  const user = await auth.getUser(context.auth.uid);\n\n  const account = await stripe.accounts.create({\n    type: "express",\n    country: "JP",\n    email: user.email,\n    business_type: "individual",\n    company: {\n      name: user.displayName,\n    },\n    business_profile: {\n      url: "https://flock-team.github.io/stripe-doc",\n    },\n  });\n\n  return db.doc(`stripeAccounts/${user.uid}`).set({\n    stripeAccountId: account.id,\n  });\n});\n```'},9605:function(e,n,t){"use strict";t.r(n),n.default='\u4ee5\u4e0b\u306e\u30b3\u30fc\u30c9\u3092\u8ffd\u8a18\u3059\u308b\u3053\u3068\u3067\u30e6\u30fc\u30b6\u30fc\u304c\u8a8d\u8a3c\u3055\u308c\u305f\u969b\u306bStripe\u306b\u30ab\u30b9\u30bf\u30de\u30fc\u3092\u4f5c\u6210\u3057\u305f\u4e0a\u3067\u30ab\u30b9\u30bf\u30de\u30fcID\u3092Firebase\uff08Firestore\uff09\u306b\u4fdd\u5b58\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\n```ts:index.ts\nimport * as admin from "firebase-admin";\n\nadmin.initializeApp();\n\nconst db = admin.firestore();\nconst fns = functions.region("asia-northeast1");\n\n// \u7701\u7565\n\nexport const createCustomer = fns.auth.user().onCreate(async (user) => {\n  const customer = await stripe.customers.create({\n    name: user.displayName,\n    email: user.email,\n    metadata: {\n      firebaseUID: user.uid,\n    },\n  });\n\n  return db.doc(`customers/${user.uid}`).set({\n    stripeId: customer.id,\n  });\n});\n```\n\n\u8a18\u8ff0\u304c\u7d42\u308f\u3063\u305f\u3089\u95a2\u6570\u3092\u30c7\u30d7\u30ed\u30a4\u3057\u307e\u3059\u3002\u30c7\u30d7\u30ed\u30a4\u306e\u524d\u306bFirebase\u306e\u30d7\u30e9\u30f3\u3092Blaze\u306b\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\u7ba1\u7406\u30b3\u30f3\u30bd\u30fc\u30eb\u5de6\u4e0b\u304b\u3089\u30d7\u30e9\u30f3\u3092\u30a2\u30c3\u30d7\u30b0\u30ec\u30fc\u30c9\u3067\u304d\u307e\u3059\u3002\n\n![](/docs/images/2022-01-29-15-14-27.png)\n\n:::info\n\u30af\u30ec\u30b8\u30c3\u30c8\u30ab\u30fc\u30c9\u767b\u9332\u304c\u5fc5\u8981\u3067\u3059\u304c \u7121\u6599\u67a0 \u304c\u3042\u308b\u305f\u3081\u591a\u304f\u306e\u30a2\u30af\u30bb\u30b9\u304c\u306a\u3044\u304b\u304e\u308a\u8ab2\u91d1\u3055\u308c\u308b\u3053\u3068\u306f\u3042\u308a\u307e\u305b\u3093\u3002\n:::\n\n\u30a2\u30c3\u30d7\u30b0\u30ec\u30fc\u30c9\u304c\u7d42\u308f\u3063\u305f\u3089**functions\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3067**\u4ee5\u4e0b\u306e\u30b3\u30de\u30f3\u30c9\u3092\u4f7f\u3063\u3066\u95a2\u6570\u3092\u30c7\u30d7\u30ed\u30a4\u3057\u307e\u3059\u3002\n\n```bash:\u30bf\u30fc\u30df\u30ca\u30eb\nfirebase deploy --only functions\n```\n\n[\u30b3\u30f3\u30bd\u30fc\u30eb\u306e\u95a2\u6570\u4e00\u89a7\u753b\u9762](https://console.firebase.google.com/project/_/functions/list?hl=ja)\u306b `createCustomer` \u304c\u8868\u793a\u3055\u308c\u3066\u3044\u308c\u3070\u30c7\u30d7\u30ed\u30a4\u306f\u5b8c\u4e86\u3067\u3059\u3002'},9170:function(e,n,t){"use strict";t.r(n),n.default="[Cloud Firestore \u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u3092\u4f5c\u6210](https://firebase.google.com/docs/firestore/quickstart#create)\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\n| \u8a2d\u5b9a\u9805\u76ee                   | \u63a8\u5968\u8a2d\u5b9a                                             |\n| -------------------------- | ---------------------------------------------------- |\n| \u30bb\u30ad\u30e5\u30ea\u30c6\u30a3 \u30eb\u30fc\u30eb        | \u30ed\u30c3\u30af\u30e2\u30fc\u30c9(\u672c\u756a)                                   |\n| \u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306e\u30ed\u30b1\u30fc\u30b7\u30e7\u30f3 | asia-northeast1(\u6771\u4eac) \u3082\u3057\u304f\u306f asia-northeast2(\u5927\u962a) |"},5977:function(e,n,t){"use strict";t.r(n),n.default="[Firebase \u30b3\u30f3\u30bd\u30fc\u30eb](https://console.firebase.google.com/)\u3067 [\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3092\u8ffd\u52a0] \u3092\u30af\u30ea\u30c3\u30af\u3057\u3001\u753b\u9762\u306e\u6307\u793a\u306b\u6cbf\u3063\u3066\u3001Firebase \u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3092\u4f5c\u6210\u3057\u3066\u304f\u3060\u3055\u3044\u3002"},6668:function(e,n,t){"use strict";t.r(n),n.default="[\u30a2\u30d7\u30ea\u306e\u767b\u9332](https://firebase.google.com/docs/web/setup?hl=ja#register-app)\u3092\u884c\u306a\u3063\u3066\u304f\u3060\u3055\u3044\u3002\u767b\u9332\u5f8c\u306b\u751f\u6210\u3055\u308c\u308b\u8a2d\u5b9a\u30b3\u30fc\u30c9\u306f\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u5185\u3067\u300c[Firebase\u306e\u521d\u671f\u5316](?id=nextjs-firebase-initialize)\u300d\u3067\u4f7f\u3044\u307e\u3059\u3002"},1014:function(e,n,t){"use strict";t.r(n),n.default='\u4ee5\u4e0b\u306e\u30b3\u30fc\u30c9\u3092\u8ffd\u52a0\u3057\u3066\u30c0\u30c3\u30b7\u30e5\u30dc\u30fc\u30c9\u306e\u30ea\u30f3\u30af\u3092\u751f\u6210\u3057\u307e\u3059\u3002\n\n```tsx:functions/index.tsx \nexport const getDashboardLink = fns.https.onCall(async (_, context) => {\n  if (!context.auth) {\n    throw new functions.https.HttpsError("unauthenticated", "\u30ed\u30b0\u30a4\u30f3\u304c\u5fc5\u8981\u3067\u3059");\n  }\n\n  const accountSnap = await db.doc(`stripeAccounts/${context.auth.uid}`).get();\n  const account = accountSnap.data()?.stripeAccountId as string;\n\n  const link = await stripe.accounts.createLoginLink(account);\n  return link.url;\n});\n```\n\n\u5b9f\u88c5\u5f8c\u3001\u30c7\u30d7\u30ed\u30a4\u3092\u884c\u3044\u307e\u3059\u3002\n\n```bash:\u30bf\u30fc\u30df\u30ca\u30eb\nfirebase deploy --only functions\n```'},6646:function(e,n,t){"use strict";t.r(n),n.default="\u6ce8\u610f: \u4e8b\u524d\u306b [Firebase CLI \u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb](https://firebase.google.com/docs/cli?hl=ja#install_the_firebase_cli) \u304c\u5fc5\u8981\u3067\u3059\u3002\n\n\u307e\u305a\u306fFirebase\u306b\u30ed\u30b0\u30a4\u30f3\u3057\u307e\u3059\u3002\u4ee5\u4e0b\u306e\u30b3\u30de\u30f3\u30c9\u306b\u3088\u3063\u3066\u30d6\u30e9\u30a6\u30b6\u304c\u7acb\u3061\u4e0a\u304c\u308b\u306e\u3067\u30ed\u30b0\u30a4\u30f3\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\n```bash:\u30bf\u30fc\u30df\u30ca\u30eb\nfirebsae login\n```\n\n\u6b21\u306b\u4ee5\u4e0b\u306e\u30b3\u30de\u30f3\u30c9\u3067Firebase\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3092\u521d\u671f\u5316\u3057\u307e\u3059\u3002\n\n```bash:\u30bf\u30fc\u30df\u30ca\u30eb\nfirebase init\n```\n\nCloud Functions\u306b\u30c1\u30a7\u30c3\u30af\uff08\u30b9\u30da\u30fc\u30b9\u30ad\u30fc\uff09\u3092\u5165\u308c\u3066\u30a8\u30f3\u30bf\u30fc\u3067\u9032\u307f\u307e\u3059\u3002 `Use an existing project` \u3067\u4f5c\u6210\u3057\u305fFirebase\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3092\u9078\u629e\u3057\u307e\u3059\u3002\n\n\u8a00\u8a9e\u306f `TypeScript` \u3092\u63a8\u5968\u3057\u307e\u3059\u3002ESLint\u3082\u5c0e\u5165\u3057\u305f\u3044\u306e\u3067\u3001\u305d\u308c\u4ee5\u964d\u30a8\u30f3\u30bf\u30fc\u3092\u91cd\u306d\u3066\u9805\u76ee\u3092 `Yes` \u3068\u3057\u3066\u9032\u3081\u3066\u304f\u3060\u3055\u3044\u3002\n\n\u6700\u7d42\u7684\u306b\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u304c\u7d42\u308f\u308c\u3070 Firebase\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306e\u521d\u671f\u5316\u306f\u5b8c\u4e86\u3067\u3059\u3002"},3047:function(e,n,t){"use strict";t.r(n),n.default=":::info\n\u4e8b\u524d\u306b\u300c[\u5236\u9650\u4ed8\u304dAPI\u30ad\u30fc](?id=stripe-create-api-key)\u300d\u3092\u5b8c\u4e86\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n:::\n\n[Run Payments with Stripe \u62e1\u5f35\u6a5f\u80fd](https://firebase.google.com/products/extensions/stripe-firestore-stripe-payments?hl=ja)\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u3066\u304f\u3060\u3055\u3044\u3002\u305d\u306e\u904e\u7a0b\u3067 Blaze \u30d7\u30e9\u30f3\u306b\u30a2\u30c3\u30d7\u30b0\u30ec\u30fc\u30c9\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\n\n\u30af\u30ec\u30b8\u30c3\u30c8\u30ab\u30fc\u30c9\u767b\u9332\u304c\u5fc5\u8981\u3067\u3059\u304c [\u7121\u6599\u67a0](https://firebase.google.com/pricing?hl=ja) \u304c\u3042\u308b\u305f\u3081\u591a\u304f\u306e\u30a2\u30af\u30bb\u30b9\u304c\u306a\u3044\u304b\u304e\u308a\u8ab2\u91d1\u3055\u308c\u308b\u3053\u3068\u306f\u3042\u308a\u307e\u305b\u3093\u3002\n\n| \u8a2d\u5b9a\u9805\u76ee                              | \u5024                                                             |\n| ------------------------------------- | -------------------------------------------------------------- |\n| Cloud Functions deployment location   | **asia-northeast1(Tokyo)** \u3082\u3057\u304f\u306f **asia-northeast2(Osaka)** |\n| Stripe API key with restricted access | [\u5236\u9650\u4ed8\u304dAPI\u30ad\u30fc](?id=stripe-create-api-key)                   |\n\n\u4e0a\u8a18\u4ee5\u5916\u306f\u30c7\u30d5\u30a9\u30eb\u30c8\u306e\u307e\u307e\u3067\u69cb\u3044\u307e\u305b\u3093\u3002\u5404\u8a2d\u5b9a\u65b9\u6cd5\u306e\u6982\u8981\u306f[\u62e1\u5f35\u6a5f\u80fd\u306eREADME](https://github.com/stripe/stripe-firebase-extensions/blob/master/firestore-stripe-payments/README.md#note-from-firebase)\u3092\u53c2\u7167\u3057\u3066\u304f\u3060\u3055\u3044\u3002"},2108:function(e,n,t){"use strict";t.r(n),n.default='\u521d\u671f\u5316\u3057\u305fFirebase\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306e\u4e2d\u306b `functions` \u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u304c\u3042\u308b\u306e\u3067**\u305d\u3053\u306b\u79fb\u52d5\u3057\u305f\u4e0a\u3067**\u4ee5\u4e0b\u306e\u30b3\u30de\u30f3\u30c9\u3092\u5b9f\u884c\u3057\u307e\u3059\u3002\n\n```bash:\u30bf\u30fc\u30df\u30ca\u30eb\nnpm install stripe\n```\n\n\u3053\u308c\u306b\u3088\u308a Cloud Functions \u3067 Stripe \u306e\u6a5f\u80fd\u306b\u30a2\u30af\u30bb\u30b9\u3067\u304d\u308b\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002Stripe\u306b\u30a2\u30af\u30bb\u30b9\u3059\u308b\u306b\u306f\u30b7\u30fc\u30af\u30ec\u30c3\u30c8\u30ad\u30fc\u304c\u5fc5\u8981\u306a\u306e\u3067\u3001Stripe\u30c0\u30c3\u30b7\u30e5\u30dc\u30fc\u30c9\u304b\u3089\u30b7\u30fc\u30af\u30ec\u30c3\u30c8\u30ad\u30fc\u3092\u53d6\u5f97\u3057\u3066[Cloud Functions\u306e\u74b0\u5883\u5909\u6570](https://firebase.google.com/docs/functions/config-env?hl=ja)\u306b\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n\n```bash:\u30bf\u30fc\u30df\u30ca\u30eb\nfirebase functions:config:set stripe.key=\u30b7\u30fc\u30af\u30ec\u30c3\u30c8\u30ad\u30fc\n```\n\n:::warning\n\u30b7\u30fc\u30af\u30ec\u30c3\u30c8\u30ad\u30fc\u3092\u4f7f\u3046\u3068Stripe\u30a2\u30ab\u30a6\u30f3\u30c8\u306b\u5bfe\u3057\u7121\u5236\u9650\u306b\u5909\u66f4\u3092\u52a0\u3048\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\u30b7\u30fc\u30af\u30ec\u30c3\u30c8\u30ad\u30fc\u304c\u5916\u90e8\u306b\u6f0f\u308c\u306a\u3044\u3088\u3046\u3001\u4eca\u56de\u306e\u3088\u3046\u306b\u74b0\u5883\u5909\u6570\u3092\u4f7f\u3046\u306a\u3069\u3057\u3066\u30b3\u30fc\u30c9\u306b\u76f4\u63a5\u8a18\u8ff0\u3057\u306a\u3044\u3088\u3046\u306b\u3057\u307e\u3057\u3087\u3046\u3002\n:::\n\n\u6700\u5f8c\u306b\u4ee5\u4e0b\u306e\u30b3\u30fc\u30c9\u3092 `index.ts` \u306b\u52a0\u3048\u3066Stripe\u306e\u6e96\u5099\u306f\u5b8c\u4e86\u3067\u3059\u3002\n\n```ts:index.ts\nimport Stripe from "stripe";\n\nconst stripe = new Stripe(functions.config().stripe.key, {\n  apiVersion: "2020-08-27",\n});\n```'},9163:function(e,n,t){"use strict";t.r(n),n.default=":::info\n\u5148\u306b\u300c[Webhook\u3092\u4f5c\u6210](?id=stripe-create-webhook)\u300d\u3092\u5b8c\u4e86\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n:::\n\nStripe \u3067 Webhook \u306e\u4f5c\u6210\u3092\u3057\u305f\u969b\u306b**\u7f72\u540d\u30b7\u30fc\u30af\u30ec\u30c3\u30c8**\u304c\u751f\u6210\u3055\u308c\u307e\u3059\u3002\u305d\u306e\u5185\u5bb9\u3092[\u62e1\u5f35\u6a5f\u80fd\u306e\u8a2d\u5b9a](https://console.firebase.google.com/u/0/project/_/extensions/instances/firestore-stripe-payments?hl=ja&tab=details)\u306e[Stripe webhook secret (Optional)]\u306b\u5165\u529b\u3057\u3001\u62e1\u5f35\u6a5f\u80fd\u3092\u518d\u69cb\u7bc9\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\n![](/docs/images/2022-01-22-15-29-46.png)"},7434:function(e,n,t){"use strict";t.r(n),n.default='\u4ee5\u4e0b\u306e\u95a2\u6570\u3092\u8ffd\u52a0\u3057\u3066\u30c7\u30d7\u30ed\u30a4\u3057\u307e\u3059\u3002\n\n```ts:functions/index.ts\n// \u8ffd\u52a0\nexport const getStripeAccountFormLink = fns.https\n    .onCall(async (account) => {\n      const accountLink = await stripe.accountLinks.create({\n        account,\n        refresh_url: "http://localhost:3000",\n        return_url: "http://localhost:3000",\n        type: "account_onboarding",\n      });\n\n      return accountLink.url;\n    });\n\nconst endpointSecret = ""; // Webhook\u4f5c\u6210\u5f8c\u306b\u7f72\u540d\u30b7\u30fc\u30af\u30ec\u30c3\u30c8\u3092\u5b9f\u88c5\n\nexport const handleStripeWebhook = fns.https\n    .onRequest(async (req, res) => {\n      const sig = req.headers["stripe-signature"];\n\n      let event;\n\n      try {\n        event = stripe.webhooks.constructEvent(\n            req.rawBody,\n            sig as string,\n            endpointSecret);\n      } catch (err) {\n        res.status(400).send(`Webhook Error: ${(err as Error).message}`);\n        return;\n      }\n\n      switch (event.type) {\n        case "account.updated": {\n          const account = event.data.object as Stripe.Account;\n          const accountSnap = await db.collection("stripeAccounts")\n              .where("stripeAccountId", "==", account.id).get();\n\n          if (!accountSnap.empty) {\n            const accountRef = accountSnap.docs[0].ref;\n            accountRef.update({\n              valid: account.charges_enabled,\n            });\n          }\n          break;\n        }\n      }\n\n      res.status(200).send("success");\n    });\n```\n\n```bash:\u30bf\u30fc\u30df\u30ca\u30eb\nfirebase deploy --only functions\n```\n\n[Stripe Connect\u7528Webhook\u306e\u4f5c\u6210](?id=stripe-connect-account-webhook)\u304c\u7d42\u308f\u3063\u305f\u3089\u7f72\u540d\u30b7\u30fc\u30af\u30ec\u30c3\u30c8\u3092\u5165\u529b\u3057\u3066\u518d\u5ea6\u30c7\u30d7\u30ed\u30a4\u3057\u3066\u304f\u3060\u3055\u3044\u3002'},7445:function(e,n,t){"use strict";t.r(n),n.default="[[\u30eb\u30fc\u30eb]\u30bf\u30d6](https://console.firebase.google.com/u/0/project/_/firestore/rules?hl=ja)\u3067[[\u3053\u306e\u62e1\u5f35\u6a5f\u80fd\u306e\u52d5\u4f5c]](https://console.firebase.google.com/project/_/extensions/instances/firestore-stripe-payments?tab=details)\u306b\u8a18\u8f09\u3055\u308c\u3066\u3044\u308b\u30eb\u30fc\u30eb\u3092\u8cbc\u308a\u4ed8\u3051\u307e\u3059\u3002\n\n[Run Payments with Stripe: README](https://github.com/stripe/stripe-firebase-extensions/blob/master/firestore-stripe-payments/POSTINSTALL.md#set-your-cloud-firestore-security-rules)"},3439:function(e,n,t){"use strict";t.r(n),n.default=":::info\n\u4e8b\u524d\u306b\u300c[\u30ab\u30b9\u30bf\u30de\u30fc\u4f5c\u6210\u30c8\u30ea\u30ac\u30fc\u306e\u30c7\u30d7\u30ed\u30a4](?id=firebase-create-customer)\u300d\u3092\u5b8c\u4e86\u3055\u305b\u3066\u304f\u3060\u3055\u3044\u3002\n:::\n\n\u4ee5\u4e0b\u306e\u30b3\u30fc\u30c9\u3067\u30ed\u30b0\u30a4\u30f3\u6a5f\u80fd\u3092\u5b9f\u88c5\u3067\u304d\u307e\u3059\u3002\n\n```tsx:pages.index.tsx\nimport {\n  GoogleAuthProvider,\n  onAuthStateChanged,\n  signInWithPopup,\n  signOut,\n  User,\n} from 'firebase/auth';\nimport type { NextPage } from 'next';\nimport Head from 'next/head';\nimport { useEffect, useState } from 'react';\nimport { auth } from '../lib/firebase';\nimport styles from '../styles/Home.module.css';\n\nconst Home: NextPage = () => {\n  const [user, setUser] = useState<User | null>(null);\n\n  useEffect(() => {\n    // \u30ed\u30b0\u30a4\u30f3\u30e6\u30fc\u30b6\u30fc\u306e\u76e3\u8996\u3068\u30bb\u30c3\u30c8\n    onAuthStateChanged(auth, (firebaseUser) => {\n      setUser(firebaseUser);\n    });\n  }, []);\n\n  // \u30ed\u30b0\u30a4\u30f3\n  const login = () => {\n    signInWithPopup(auth, new GoogleAuthProvider());\n  };\n\n  // \u30ed\u30b0\u30a2\u30a6\u30c8\n  const logout = () => {\n    signOut(auth);\n  };\n\n  return (\n    <div className={styles.container}>\n      <Head>\n        <title>Create Next App</title>\n        <meta name=\"description\" content=\"Generated by create next app\" />\n        <link rel=\"icon\" href=\"/favicon.ico\" />\n      </Head>\n\n      <main>\n        {user ? (\n          <button onClick={logout}>\u30ed\u30b0\u30a2\u30a6\u30c8</button>\n        ) : (\n          <button onClick={login}>\u30ed\u30b0\u30a4\u30f3</button>\n        )}\n\n        {user && <p>{user.displayName}\u3055\u3093\u3088\u3046\u3053\u305d</p>}\n      </main>\n    </div>\n  );\n};\n\nexport default Home;\n```\n\n\u30ed\u30b0\u30a4\u30f3\u5f8c\u306b\u4ee5\u4e0b\u3092\u78ba\u8a8d\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\n- Stripe\u30c0\u30c3\u30b7\u30e5\u30dc\u30fc\u30c9\u306e\u9867\u5ba2\u30da\u30fc\u30b8\u306b\u30ab\u30b9\u30bf\u30de\u30fc\u304c\u8ffd\u52a0\u3055\u308c\u3066\u3044\u308b\u3053\u3068\n- Firestore\u306e `customers` \u30b3\u30ec\u30af\u30b7\u30e7\u30f3\u306b\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u4f5c\u6210\u3055\u308c\u3066\u3044\u308b\u3053\u3068"},1879:function(e,n,t){"use strict";t.r(n),n.default="\u4ee5\u4e0b\u306e\u30b3\u30fc\u30c9\u3067\u30ed\u30b0\u30a4\u30f3\u6a5f\u80fd\u306e\u5b9f\u88c5\u3092\u884c\u3044\u307e\u3059\u3002\n\n```tsx:pages/index.tsx\nimport {\n  GoogleAuthProvider,\n  onAuthStateChanged,\n  signInWithPopup,\n  signOut,\n  User,\n} from 'firebase/auth';\nimport type { NextPage } from 'next';\nimport Head from 'next/head';\nimport { useEffect, useState } from 'react';\nimport { auth } from '../lib/firebase';\nimport styles from '../styles/Home.module.css';\n\nconst Home: NextPage = () => {\n  const [user, setUser] = useState<User | null>(null);\n\n  useEffect(() => {\n    // \u30ed\u30b0\u30a4\u30f3\u30e6\u30fc\u30b6\u30fc\u306e\u76e3\u8996\u3068\u30bb\u30c3\u30c8\n    onAuthStateChanged(auth, (firebaseUser) => {\n      setUser(firebaseUser);\n    });\n  }, []);\n\n  // \u30ed\u30b0\u30a4\u30f3\n  const login = () => {\n    signInWithPopup(auth, new GoogleAuthProvider());\n  };\n\n  // \u30ed\u30b0\u30a2\u30a6\u30c8\n  const logout = () => {\n    signOut(auth);\n  };\n\n  return (\n    <div className={styles.container}>\n      <Head>\n        <title>Create Next App</title>\n        <meta name=\"description\" content=\"Generated by create next app\" />\n        <link rel=\"icon\" href=\"/favicon.ico\" />\n      </Head>\n\n      <main>\n        {user ? (\n          <button onClick={logout}>\u30ed\u30b0\u30a2\u30a6\u30c8</button>\n        ) : (\n          <button onClick={login}>\u30ed\u30b0\u30a4\u30f3</button>\n        )}\n\n        {user && <p>{user.displayName}\u3055\u3093\u3088\u3046\u3053\u305d</p>}\n      </main>\n    </div>\n  );\n};\n\nexport default Home;\n```"},555:function(e,n,t){"use strict";t.r(n),n.default="[\u30c1\u30a7\u30c3\u30af\u30a2\u30a6\u30c8](https://stripe.com/jp/payments/checkout#:~:text=Stripe%20Checkout%20%E3%81%AF%E3%82%B3%E3%83%B3%E3%83%90%E3%83%BC%E3%82%B8%E3%83%A7%E3%83%B3%E3%81%AE,%E5%8F%97%E3%81%91%E3%82%8B%E3%81%93%E3%81%A8%E3%81%8C%E3%81%A7%E3%81%8D%E3%81%BE%E3%81%99%E3%80%82)URL\u3092\u751f\u6210\u3059\u308b\u30e1\u30bd\u30c3\u30c9\u3092\u4f5c\u6210\u3057\u3001\u30dc\u30bf\u30f3\u3092\u8ffd\u52a0\u3057\u307e\u3059\u3002\n\n```tsx:components/product-list.tsx\nimport {\n  addDoc,\n  collection,\n  getDocs,\n  onSnapshot,\n  query,\n  where,\n} from 'firebase/firestore';\n\n// \u7701\u7565\n\nconst redirectToCheckout = async (priceId: string) => {\n  const collectionRef = collection(\n    db,\n    `customers/${user.uid}/checkout_sessions`\n  );\n  const docRef = await addDoc(collectionRef, {\n    billing_address_collection: 'auto',\n    success_url: window.location.origin,\n    cancel_url: window.location.origin,\n    line_items: [\n      {\n        price: priceId,\n        tax_rates: ['\u7a0e\u7387\u306eID'],\n        quantity: 1,\n      },\n    ],\n  });\n\n  onSnapshot(docRef, (snap) => {\n    const { error, url } = snap.data() as {\n      url: string;\n      error: Error;\n    };\n\n    if (error) {\n      alert(`An error occured: ${error.message}`);\n    }\n\n    if (url) {\n      window.location.assign(url);\n    }\n  });\n};\n\n// \u7701\u7565\n\n<div>\n  <div key={price.id}>\n    {price.recurring.interval_count}\n    {getIntervalLabel(price.recurring.interval)}\u3054\u3068\u306b\n    {price.unit_amount.toLocaleString()}\u5186\n\n    {/* \u8ffd\u52a0 */}\n    <button onClick={() => redirectToCheckout(price.id)}>\u958b\u59cb</button>\n  </div>\n</div>\n```\n\n\u30dc\u30bf\u30f3\u3092\u30af\u30ea\u30c3\u30af\u3059\u308b\u3068\u30c1\u30a7\u30c3\u30af\u30a2\u30a6\u30c8\u304c\u958b\u59cb\u3055\u308c\u307e\u3059\u3002\n\n:::warning\nCloud Functions\u306f\u52d5\u4f5c\u304c\u9045\u3044\u305f\u3081\u30c1\u30a7\u30c3\u30af\u30a2\u30a6\u30c8\u306e\u958b\u59cb\u306b\u6570\u79d2\u5f85\u3064\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\u5b9f\u969b\u306b\u306f\u30ed\u30fc\u30c7\u30a3\u30f3\u30b0\u30a2\u30cb\u30e1\u30fc\u30b7\u30e7\u30f3\u3092\u5b9f\u88c5\u3059\u308b\u306a\u3069\u3057\u3066\u5f85\u6a5f\u4e2d\u3060\u3068\u308f\u304b\u308bUI\u306b\u3057\u307e\u3057\u3087\u3046\u3002\n:::"},6344:function(e,n,t){"use strict";t.r(n),n.default="\u4e8b\u524d\u306b[\u30c1\u30a7\u30c3\u30af\u30a2\u30a6\u30c8\u30bb\u30c3\u30b7\u30e7\u30f3\u306e\u4f5c\u6210\u95a2\u6570\u3092\u30c7\u30d7\u30ed\u30a4](?id=firebase-checkout-session-connect)\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\n\u4ee5\u4e0b\u306e\u30b3\u30fc\u30c9\u3092\u8ffd\u52a0\u3057\u3066\u8cfc\u5165\u30dc\u30bf\u30f3\u3092\u6709\u52b9\u306b\u3057\u307e\u3059\u3002\n\n```tsx:components/product-list.tsx \nimport React from 'react';\n// \u8ffd\u52a0\nimport { httpsCallable } from 'firebase/functions';\nimport { fns } from '../lib/firebase';\n\nconst ProductList = () => {\n  // \u8ffd\u52a0\n  const startCheckout = async () => {\n    const callable = httpsCallable(fns, 'createCheckoutSession');\n    const { data } = await callable();\n    window.location.assign(data as string);\n  };\n\n  return (\n    <div>\n      <h2>\u30c1\u30b1\u30c3\u30c8</h2>\n      <p>1500\u5186</p>\n      {/* \u8ffd\u52a0 */}\n      <button onClick={startCheckout}>\u8cfc\u5165</button>\n    </div>\n  );\n};\n\nexport default ProductList;\n```\n\n\u8cfc\u5165\u30dc\u30bf\u30f3\u3092\u30af\u30ea\u30c3\u30af\u3059\u308b\u3068\u30c1\u30a7\u30c3\u30af\u30a2\u30a6\u30c8\u30bb\u30c3\u30b7\u30e7\u30f3\u304c\u958b\u59cb\u3055\u308c\u307e\u3059\u3002"},9712:function(e,n,t){"use strict";t.r(n),n.default="\u30b3\u30f3\u30dd\u30fc\u30cd\u30f3\u30c8\u5185\u306b[\u30c1\u30a7\u30c3\u30af\u30a2\u30a6\u30c8](https://stripe.com/jp/payments/checkout#:~:text=Stripe%20Checkout%20%E3%81%AF%E3%82%B3%E3%83%B3%E3%83%90%E3%83%BC%E3%82%B8%E3%83%A7%E3%83%B3%E3%81%AE,%E5%8F%97%E3%81%91%E3%82%8B%E3%81%93%E3%81%A8%E3%81%8C%E3%81%A7%E3%81%8D%E3%81%BE%E3%81%99%E3%80%82)\u3078\u306e\u30ea\u30c0\u30a4\u30ec\u30af\u30c8\u30e1\u30bd\u30c3\u30c9\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n\n```tsx:components/product-list.tsx\nimport { addDoc, collection, getDocs, onSnapshot, query, where } from 'firebase/firestore';\n\n// \u7701\u7565\n\n  const redirectToCheckout = async (priceId: string) => {\n    const collectionRef = collection(\n      db,\n      `customers/${user.uid}/checkout_sessions`\n    );\n    const docRef = await addDoc(collectionRef, {\n      mode: 'payment',\n      billing_address_collection: 'auto',\n      success_url: window.location.origin,\n      cancel_url: window.location.origin,\n      line_items: [\n        {\n          price: priceId,\n          tax_rates: ['\u7a0e\u7387\u306eID'],\n          quantity: 1,\n        },\n      ],\n    });\n\n    onSnapshot(docRef, (snap) => {\n      const { error, url } = snap.data() as {\n        url: string;\n        error: Error;\n      };\n\n      if (error) {\n        alert(`An error occured: ${error.message}`);\n      }\n\n      if (url) {\n        window.location.assign(url);\n      }\n    });\n  };\n```\n\n\u8cfc\u5165\u30dc\u30bf\u30f3\u3092\u8ffd\u52a0\u3057\u307e\u3059\u3002\n\n```tsx:components/product-list.tsx\n<div>\n  {price.description || '\u901a\u5e38'} -{' '}\n  {price.unit_amount.toLocaleString()}\u5186\n  <button onClick={() => redirectToCheckout(price.id)}>\u8cfc\u5165</button> {/* \u8ffd\u52a0 */}\n</div>\n```\n\n\u4e0a\u8a18\u3092\u30af\u30ea\u30c3\u30af\u3059\u308b\u3053\u3068\u3067 Stripe \u30c1\u30a7\u30c3\u30af\u30a2\u30a6\u30c8 \u304c\u958b\u59cb\u3055\u308c\u307e\u3059\u3002\n\n[Run Payments with Stripe: README](https://stripe.com/jp/payments/checkout#:~:text=Stripe%20Checkout%20%E3%81%AF%E3%82%B3%E3%83%B3%E3%83%90%E3%83%BC%E3%82%B8%E3%83%A7%E3%83%B3%E3%81%AE,%E5%8F%97%E3%81%91%E3%82%8B%E3%81%93%E3%81%A8%E3%81%8C%E3%81%A7%E3%81%8D%E3%81%BE%E3%81%99%E3%80%82)\n\n:::warning\nCloud Functions\u306f\u52d5\u4f5c\u304c\u9045\u3044\u305f\u3081\u30c1\u30a7\u30c3\u30af\u30a2\u30a6\u30c8\u306e\u958b\u59cb\u306b\u6570\u79d2\u5f85\u3064\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\u5b9f\u969b\u306b\u306f\u30ed\u30fc\u30c7\u30a3\u30f3\u30b0\u30a2\u30cb\u30e1\u30fc\u30b7\u30e7\u30f3\u3092\u5b9f\u88c5\u3059\u308b\u306a\u3069\u3057\u3066\u5f85\u6a5f\u4e2d\u3060\u3068\u308f\u304b\u308bUI\u306b\u3057\u307e\u3057\u3087\u3046\u3002\n:::"},4742:function(e,n,t){"use strict";t.r(n),n.default=":::info\n\u4e8b\u524d\u306b\u300c[Connect\u30a2\u30ab\u30a6\u30f3\u30c8\u4f5c\u6210\u95a2\u6570\u3092\u4f5c\u6210](?id=firebase-create-connect-account)\u300d\u3092\u5b8c\u4e86\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n:::\n\nConnect\u30a2\u30ab\u30a6\u30f3\u30c8\u8868\u793a\u7528\u30b3\u30f3\u30dd\u30fc\u30cd\u30f3\u30c8\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n\n```tsx:components/stripe-account.tsx\nimport { User } from 'firebase/auth';\nimport { doc, getDoc } from 'firebase/firestore';\nimport { httpsCallable } from 'firebase/functions';\nimport React, { useEffect, useState } from 'react';\nimport { db, fns } from '../lib/firebase';\n\ntype StripeAccount = {\n  stripeAccountId: string;\n  valid: boolean;\n};\n\ntype Props = {\n  user: User;\n};\n\nconst StripeAccount = ({ user }: Props) => {\n  const [stripeAccount, setStripeAccount] = useState<StripeAccount | null>(\n    null\n  );\n\n  useEffect(() => {\n    getStripeAccount().then((account) => setStripeAccount(account));\n  }, []);\n\n  const getStripeAccount = async () => {\n    const ref = doc(db, `stripeAccounts/${user.uid}`);\n    const snap = await getDoc(ref);\n    return snap.data() as StripeAccount;\n  };\n\n  const createStripeAccount = async () => {\n    const callable = httpsCallable(fns, 'createStripeAccount');\n    try {\n      await callable();\n      setStripeAccount(await getStripeAccount());\n    } catch (error) {\n      alert('\u8ca9\u58f2\u30a2\u30ab\u30a6\u30f3\u30c8\u306e\u4f5c\u6210\u306b\u5931\u6557\u3057\u307e\u3057\u305f');\n    }\n  };\n\n  return (\n    <div>\n      {!stripeAccount && (\n        <div>\n          <button onClick={createStripeAccount}>\u8ca9\u58f2\u3092\u306f\u3058\u3081\u308b</button>\n        </div>\n      )}\n      {stripeAccount && (\n        <p>Connect\u30a2\u30ab\u30a6\u30f3\u30c8ID: {stripeAccount.stripeAccountId}</p>\n      )}\n      {stripeAccount && !stripeAccount.valid && <button>\u8ca9\u58f2\u8005\u60c5\u5831\u3092\u767b\u9332\u3057\u3066\u304f\u3060\u3055\u3044</button>}\n    </div>\n  );\n};\n\nexport default StripeAccount;\n```\n\n\u30b3\u30f3\u30dd\u30fc\u30cd\u30f3\u30c8\u3092\u30c8\u30c3\u30d7\u30da\u30fc\u30b8\u306b\u5b9f\u88c5\u3057\u307e\u3059\u3002\n\n```tsx:pages/index.tsx\n// \u8ffd\u52a0\n{user && <StripeAccount user={user} />}\n```\n\n\u8868\u793a\u3055\u308c\u308b\u30dc\u30bf\u30f3\u3092\u30af\u30ea\u30c3\u30af\u3057\u3066Connect\u30a2\u30ab\u30a6\u30f3\u30c8\u306eID\u304c\u8868\u793a\u3055\u308c\u305f\u3089\u5b8c\u4e86\u3067\u3059\u3002\u307e\u3060\u8ca9\u58f2\u3067\u304d\u308b\u72b6\u614b\u3067\u306f\u306a\u3044\u305f\u3081\u3001[\u5fc5\u8981\u306a\u78ba\u8a8d\u60c5\u5831](https://stripe.com/docs/connect/required-verification-information#US-full-individual--transfer)\u3092\u5165\u529b\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002"},8931:function(e,n,t){"use strict";t.r(n),n.default=":::info\n\u4e8b\u524d\u306b\u300c[\u30ab\u30b9\u30bf\u30de\u30fc\u30dd\u30fc\u30bf\u30eb\u306e\u8a2d\u5b9a](?id=stripe-customer-portal-customize)\u300d\u3092\u5b8c\u4e86\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n:::\n\n[\u30ab\u30b9\u30bf\u30de\u30fc\u30dd\u30fc\u30bf\u30eb](https://stripe.com/docs/billing/subscriptions/integrating-customer-portal)\u306fStripe\u304c\u7528\u610f\u3059\u308b\u30da\u30fc\u30b8\u3067\u3001\u9867\u5ba2\u306f\u305d\u306e\u4e2d\u3067\u6c7a\u6e08\u65b9\u6cd5\u306e\u4fdd\u5b58\u3084\u5909\u66f4\u304c\u3067\u304d\u307e\u3059\u3002\n\n\u30ab\u30b9\u30bf\u30de\u30fc\u30dd\u30fc\u30bf\u30eb\u306eURL\u306f\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u306e\u89b3\u70b9\u304b\u3089\u56fa\u5b9a\u3067\u306f\u306a\u3044\u305f\u3081\u3001\u90fd\u5ea6\u4e00\u6642\u7684\u306aURL\u3092Stripe\u306b\u30ea\u30af\u30a8\u30b9\u30c8\u3057\u3066\u304b\u3089\u30ea\u30c0\u30a4\u30ec\u30af\u30c8\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\n\n\u4ee5\u4e0b\u306e\u30b3\u30fc\u30c9\u3067\u30ab\u30b9\u30bf\u30de\u30fc\u30dd\u30fc\u30bf\u30eb\u306b\u9077\u79fb\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\n```tsx:components/customer-portal.tsx\nimport { httpsCallable, HttpsCallableResult } from 'firebase/functions';\nimport React from 'react';\nimport { fns } from '../lib/firebase';\n\nconst CustomerPortal = () => {\n  const openCustomerPortal = async () => {\n    const callable = httpsCallable(\n      fns,\n      'ext-firestore-stripe-payments-createPortalLink'\n    );\n\n    const { data } = (await callable({\n      returnUrl: window.location.origin,\n    })) as HttpsCallableResult<{\n      url: string;\n    }>;\n\n    window.location.assign(data.url);\n  };\n\n  return (\n    <div>\n      <button onClick={openCustomerPortal}>\u652f\u6255\u3044\u60c5\u5831\u306e\u7ba1\u7406</button>\n    </div>\n  );\n};\n\nexport default CustomerPortal;\n```\n\n```tsx:pages/index.tsx\nimport CustomerPortal from '../components/customer-portal';\n\n// \u7701\u7565\n\n{user && <CustomerPortal />}\n```\n\n:::warning\nCloud Functions\u306f\u52d5\u4f5c\u304c\u9045\u3044\u305f\u3081\u30dd\u30fc\u30bf\u30ebURL\u306e\u53d6\u5f97\u3092\u6570\u79d2\u5f85\u3064\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\u5b9f\u969b\u306b\u306f\u30ed\u30fc\u30c7\u30a3\u30f3\u30b0\u30a2\u30cb\u30e1\u30fc\u30b7\u30e7\u30f3\u3092\u5b9f\u88c5\u3059\u308b\u306a\u3069\u3057\u3066\u5f85\u6a5f\u4e2d\u3060\u3068\u308f\u304b\u308bUI\u306b\u3057\u307e\u3057\u3087\u3046\u3002\n:::"},5400:function(e,n,t){"use strict";t.r(n),n.default="```tsx:pages/index.tsx\nconst [role, setRole] = useState<string>();\n\nuseEffect(() => {\n  // \u7701\u7565\n onAuthStateChanged(auth, (firebaseUser) => {\n    setUser(firebaseUser);\n    getCustomClaimRole(); // \u8ffd\u52a0\n  });\n}, [])\n\nconst getCustomClaimRole = async () => {\n  await auth.currentUser?.getIdToken(true);\n  const decodedToken = await auth.currentUser?.getIdTokenResult();\n  setRole(decodedToken?.claims.stripeRole as string);\n};\n\n// \u7701\u7565\n\n// \u8ffd\u52a0\n<p>{role === 'premium' ? '\u30d7\u30ec\u30df\u30a2\u30e0\u30d7\u30e9\u30f3' : '\u30d5\u30ea\u30fc\u30d7\u30e9\u30f3'}</p>\n```"},6809:function(e,n,t){"use strict";t.r(n),n.default=":::info\n\u4e8b\u524d\u306b\u300c[\u30c0\u30c3\u30b7\u30e5\u30dc\u30fc\u30c9\u30ea\u30f3\u30af\u751f\u6210](?id=firebase-express-dashboard)\u300d\u3092\u5b8c\u4e86\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n:::\n\n\u4ee5\u4e0b\u306e\u30b3\u30fc\u30c9\u3092\u8ffd\u52a0\u3057\u3066\u30c0\u30c3\u30b7\u30e5\u30dc\u30fc\u30c9\u3078\u306e\u30ea\u30c0\u30a4\u30ec\u30af\u30c8\u3092\u5b9f\u88c5\u3057\u307e\u3059\u3002\n\n```tsx:components/stripe-account.tsx \n// \u30e1\u30bd\u30c3\u30c9\u3092\u8ffd\u52a0\nconst redirectToDashboard = async () => {\n  const callable = httpsCallable(fns, 'getDashboardLink');\n  const { data } = await callable();\n  location.assign(data as string);\n};\n\n// \u7701\u7565\n\n// \u30ec\u30f3\u30c0\u30fc\u306b\u8ffd\u52a0\n{stripeAccount?.valid && (\n  <div>\n    <button onClick={redirectToDashboard}>\u30c0\u30c3\u30b7\u30e5\u30dc\u30fc\u30c9\u3092\u958b\u304f</button>\n  </div>\n)}\n```\n\n\u30af\u30ea\u30c3\u30af\u3059\u308b\u3068Connect\u30a2\u30ab\u30a6\u30f3\u30c8\u306e\u30c0\u30c3\u30b7\u30e5\u30dc\u30fc\u30c9\u306b\u9077\u79fb\u3057\u3001\u8ca9\u58f2\u8005\u304c\u81ea\u5206\u306e\u53ce\u76ca\u3092\u78ba\u8a8d\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\n\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u306e\u89b3\u70b9\u304b\u3089\u3053\u306eURL\u306f\u6709\u52b9\u671f\u9650\u3064\u304d\u306e\u4e00\u6642\u7684\u306a\u3082\u306e\u306b\u306a\u308a\u307e\u3059\u3002\u30c0\u30c3\u30b7\u30e5\u30dc\u30fc\u30c9\u306b\u30a2\u30af\u30bb\u30b9\u3059\u308b\u969b\u306b\u306f\u3053\u306e\u30e1\u30bd\u30c3\u30c9\u3092\u4ecb\u3057\u3066\u90fd\u5ea6Stripe\u306b\u30c0\u30c3\u30b7\u30e5\u30dc\u30fc\u30c9\u306eURL\u3092\u30ea\u30af\u30a8\u30b9\u30c8\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002"},8542:function(e,n,t){"use strict";t.r(n),n.default=":::info\n\u4e8b\u524d\u306b \u300c[\u30a2\u30d7\u30ea\u306e\u767b\u9332](?id=firebase-create-web-app)\u300d \u3092\u5b8c\u4e86\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n:::\n\n```bash:\u30bf\u30fc\u30df\u30ca\u30eb\nnpm install firebase\n```\n\n\u767b\u9332\u3057\u305f\u30a2\u30d7\u30ea\u306e\u8a2d\u5b9a\u60c5\u5831\u3092\u4f7f\u3063\u3066Firebase\u3092\u521d\u671f\u5316\u3057\u307e\u3059\u3002\n\n```ts:lib/firebsae.ts\nimport { initializeApp } from 'firebase/app';\nimport { getFirestore } from 'firebase/firestore';\nimport { getFunctions } from 'firebase/functions';\nimport { getAuth } from 'firebase/auth';\n\nconst app = initializeApp({\n  // \u767b\u9332\u3057\u305f\u30a2\u30d7\u30ea\u306e\u8a2d\u5b9a\n});\n\nexport const db = getFirestore(app);\nexport const fns = getFunctions(app, 'asia-northeast1');\nexport const auth = getFunctions(app);\n```"},8062:function(e,n,t){"use strict";t.r(n),n.default="\u62e1\u5f35\u6a5f\u80fd\u306b\u3088\u3063\u3066Stripe\u306e\u5546\u54c1\u30c7\u30fc\u30bf\u304cCloud Firestore\u306b\u540c\u671f\u3055\u308c\u3066\u3044\u308b\u306e\u3067\u3001\u305d\u306e\u60c5\u5831\u3092\u4f7f\u3063\u3066\u30d7\u30e9\u30f3\u4e00\u89a7\u3092\u8868\u793a\u3057\u307e\u3059\u3002\n\n```tsx:components/product-list.tsx\nimport { User } from 'firebase/auth';\nimport { collection, getDocs, query, where } from 'firebase/firestore';\nimport { useEffect, useState } from 'react';\nimport { db } from '../lib/firebase';\n\ntype Interval = 'month' | 'year' | 'week' | 'day';\n\ntype Price = {\n  id: string;\n  description: string;\n  unit_amount: number;\n  active: boolean;\n  type: 'recurring' | 'one_time';\n  recurring: {\n    interval: Interval;\n    interval_count: number;\n  };\n};\n\ntype Product = {\n  id: string;\n  active: boolean;\n  name: string;\n  prices: Price[];\n};\n\ntype Props = {\n  user: User;\n};\n\nconst ProductList = ({ user }: Props) => {\n  const [products, setProducts] = useState<Product[]>();\n\n  useEffect(() => {\n    const ref = collection(db, 'products');\n    const q = query(ref, where('active', '==', true));\n    getDocs(q).then(async (snap) => {\n      const promises = snap.docs.map(async (doc) => {\n        const product = {\n          ...(doc.data() as Product),\n          id: doc.id,\n        };\n        const priceRef = collection(db, doc.ref.path, 'prices');\n        const priceSnap = await getDocs(priceRef);\n        product.prices = priceSnap.docs.map((doc) => {\n          return {\n            ...doc.data(),\n            id: doc.id,\n          } as Price;\n        });\n\n        return product as Product;\n      });\n\n      setProducts(await Promise.all(promises));\n    });\n  }, []);\n\n  const getIntervalLabel = (interval: Interval) => {\n    return {\n      day: '\u65e5',\n      month: '\u304b\u6708',\n      year: '\u5e74',\n      week: '\u9031\u9593',\n    }[interval];\n  };\n\n  return (\n    <div>\n      {products\n        ?.filter((product) => product.active)\n        .map((product) => (\n          <div key={product.id}>\n            <h2>{product.name}</h2>\n            {product.prices\n              .filter((price) => price.active && price.type === 'recurring')\n              .map((price) => (\n                <div key={price.id}>\n                  {price.recurring.interval_count}\n                  {getIntervalLabel(price.recurring.interval)}\u3054\u3068\u306b\n                  {price.unit_amount.toLocaleString()}\u5186\n                </div>\n              ))}\n          </div>\n        ))}\n    </div>\n  );\n};\n\nexport default ProductList;\n```\n\n```tsx:pages/index.tsx\n// \u3053\u306e\u884c\u3092\u8ffd\u52a0\n{user && <ProductList user={user}></ProductList>}\n```\n\n[Run Payments with Stripe: README](https://github.com/stripe/stripe-firebase-extensions/blob/master/firestore-stripe-payments/POSTINSTALL.md#list-available-products-and-prices)"},3476:function(e,n,t){"use strict";t.r(n),n.default="\u4ee5\u4e0b\u306e\u30b3\u30fc\u30c9\u3067\u5546\u54c1\u3092\u8868\u793a\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\n```tsx:components/product-list.tsx \nimport React from 'react';\n\nconst ProductList = () => {\n  return (\n    <div>\n      <h2>\u30c1\u30b1\u30c3\u30c8</h2>\n      <p>1,500\u5186</p>\n      <button>\u8cfc\u5165</button>\n    </div>\n  );\n};\n\nexport default ProductList;\n```\n\n\u4e0a\u8a18\u30b3\u30f3\u30dd\u30fc\u30cd\u30f3\u30c8\u3092\u30c8\u30c3\u30d7\u30da\u30fc\u30b8\u3067\u4f7f\u7528\u3057\u307e\u3059\u3002\n\n```tsx:pages/index.tsx\n{user && <ProductList />}\n```\n\n\u4eca\u56de\u306f\u9759\u7684\u306b\u5b9f\u88c5\u3057\u3066\u3044\u307e\u3059\u304c\u3001\u5b9f\u969b\u306b\u306fStripe\u30c0\u30c3\u30b7\u30e5\u30dc\u30fc\u30c9\u306e\u5546\u54c1\u7ba1\u7406\u64cd\u4f5c\u3092Webhook\u3067\u30ad\u30e3\u30c3\u30c1\u3057\u3066Firestore\u306b\u53cd\u6620\u3055\u305b\u3066\u304f\u3060\u3055\u3044\u3002\n\n\u9759\u7684\u306b\u5b9f\u88c5\u3059\u308b\u5834\u5408\u3001Stripe\u306e\u5546\u54c1\u60c5\u5831\u3092\u624b\u4f5c\u696d\u3067\u540c\u671f\u3057\u7d9a\u3051\u308b\u5fc5\u8981\u304c\u3042\u308a\u30ea\u30b9\u30af\u304c\u9ad8\u307e\u308a\u307e\u3059\u3002"},7186:function(e,n,t){"use strict";t.r(n),n.default="\u4ee5\u4e0b\u306e\u30b3\u30fc\u30c9\u3067\u5546\u54c1\u4e00\u89a7\u3092\u8868\u793a\u3057\u307e\u3059\u3002\u3053\u306e\u60c5\u5831\u306f Run Payments with Stripe \u62e1\u5f35\u6a5f\u80fd \u306b\u3088\u308aCloud Firestore\u306b\u540c\u671f\u3055\u308c\u305f Stripe \u306e\u5546\u54c1\u3001\u4fa1\u683c\u60c5\u5831\u306b\u57fa\u3065\u3044\u3066\u3044\u307e\u3059\u3002\n\n```tsx:components/product-list.tsx\nimport { User } from 'firebase/auth';\nimport { collection, getDocs, query, where } from 'firebase/firestore';\nimport { useEffect, useState } from 'react';\nimport { db } from '../lib/firebase';\n\ntype Price = {\n  id: string;\n  description: string;\n  unit_amount: number;\n};\n\ntype Product = {\n  id: string;\n  active: boolean;\n  name: string;\n  prices: Price[];\n};\n\ntype Props = {\n  user: User;\n};\n\nconst ProductList = ({ user }: Props) => {\n  const [products, setProducts] = useState<Product[]>();\n\n  useEffect(() => {\n    const ref = collection(db, 'products');\n    const q = query(ref, where('active', '==', true));\n    getDocs(q).then(async (snap) => {\n      const promises = snap.docs.map(async (doc) => {\n        const product = {\n          ...(doc.data() as Product),\n          id: doc.id,\n        };\n        const priceRef = collection(db, doc.ref.path, 'prices');\n        const priceSnap = await getDocs(priceRef);\n        product.prices = priceSnap.docs.map((doc) => {\n          return {\n            ...doc.data(),\n            id: doc.id,\n          } as Price;\n        });\n\n        return product as Product;\n      });\n\n      setProducts(await Promise.all(promises));\n    });\n  }, []);\n\n  return (\n    <div>\n      {products?.map((product) => (\n        <div key={product.id}>\n          <h2>{product.name}</h2>\n          {product.prices.map((price) => (\n            <div key={price.id}>\n              {price.description || '\u901a\u5e38'} -{' '}\n              {price.unit_amount.toLocaleString()}\u5186\n            </div>\n          ))}\n        </div>\n      ))}\n    </div>\n  );\n};\n\nexport default ProductList;\n```\n\n```tsx:pages/index.tsx\n// \u3053\u306e\u884c\u3092\u8ffd\u52a0\n{user && <ProductList user={user}></ProductList>}\n```\n\n[Run Payments with Stripe: README](https://github.com/stripe/stripe-firebase-extensions/blob/master/firestore-stripe-payments/POSTINSTALL.md#list-available-products-and-prices)"},8992:function(e,n,t){"use strict";t.r(n),n.default="\u30c1\u30a7\u30c3\u30af\u30a2\u30a6\u30c8\u5b8c\u4e86\u6642\u306b\u62e1\u5f35\u6a5f\u80fd\u306b\u3088\u3063\u3066Cloud Firestore \u306b\u6c7a\u6e08\u60c5\u5831\u304c\u8ffd\u52a0\u3055\u308c\u307e\u3059\u3002\u305d\u306e\u60c5\u5831\u3092\u4f7f\u3063\u3066\u8cfc\u5165\u6e08\u307f\u306e\u30a2\u30a4\u30c6\u30e0\u4e00\u89a7\u3092\u8868\u793a\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\n```tsx:components/purchase-list.tsx\nimport { User } from 'firebase/auth';\nimport {\n  collection,\n  onSnapshot,\n  orderBy,\n  query,\n  where,\n} from 'firebase/firestore';\nimport { useEffect, useState } from 'react';\nimport { db } from '../lib/firebase';\n\ntype Purchase = {\n  id: string;\n  status?: 'succeeded';\n  created: number;\n  items: {\n    description: string;\n    price: {\n      id: string;\n      nickname: string;\n      unit_amount: number;\n    };\n  }[];\n};\n\ntype Props = {\n  user: User;\n};\n\nconst PurchaseList = ({ user }: Props) => {\n  const [purchases, setPurchases] = useState<Purchase[]>();\n\n  useEffect(() => {\n    const ref = collection(db, `customers/${user.uid}/payments`);\n    const q = query(\n      ref,\n      where('status', '==', 'succeeded'),\n      orderBy('created', 'desc')\n    );\n\n    return onSnapshot(q, (result) => {\n      setPurchases(result.docs.map((doc) => doc.data() as Purchase));\n    });\n  }, []);\n\n  return (\n    <div>\n      <h2>\u8cfc\u5165\u5c65\u6b74</h2>\n\n      <ul>\n        {purchases?.map((purchase) => {\n          const price = purchase.items[0].price;\n          return (\n            <li key={purchase.id}>\n              <span>{purchase.items[0].description}</span>\n              <span>{price.unit_amount.toLocaleString()}\u5186</span>\n              <span>{purchase.created}</span>\n            </li>\n          );\n        })}\n      </ul>\n    </div>\n  );\n};\n\nexport default PurchaseList;\n```\n\n```tsx:pages/index.tsx\nimport PurchaseList from '../components/purchase-list';\n\n// \u7701\u7565\n\n{user && <PurchaseList user={user}></PurchaseList>}\n```"},514:function(e,n,t){"use strict";t.r(n),n.default=":::info\n\u4e8b\u524d\u306b\u300c[\u78ba\u8a8d\u60c5\u5831\u5165\u529b\u7528\u30ea\u30f3\u30af\u3068\u30c8\u30ea\u30ac\u30fc\u95a2\u6570\u3092\u4f5c\u6210](?id=firebase-required-verification-information)\u300d\u3092\u5b8c\u4e86\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n:::\n\n\u4ee5\u4e0b\u306e\u30b3\u30fc\u30c9\u3092\u8ffd\u8a18\u3057\u3066\u78ba\u8a8d\u60c5\u5831\u5165\u529b\u30da\u30fc\u30b8\u306b\u9077\u79fb\u3057\u307e\u3059\u3002\n\n```tsx:components/stripe-account.tsx\n// \u8ffd\u52a0\nconst redirectStripeAccountForm = async () => {\n    const callable = httpsCallable(fns, 'getStripeAccountFormLink');\n    const { data } = await callable(stripeAccount?.stripeAccountId);\n    window.location.assign(data as string);\n  };\n\n// \u5909\u66f4\n{stripeAccount && !stripeAccount.valid ? (\n  <button onClick={redirectStripeAccountForm}>\n    \u8ca9\u58f2\u8005\u60c5\u5831\u3092\u767b\u9332\u3057\u3066\u304f\u3060\u3055\u3044\n  </button>\n) : (\n  <p>\u78ba\u8a8d\u60c5\u5831\u306e\u767b\u9332\u304c\u5b8c\u4e86\u3057\u3066\u3044\u307e\u3059\u2705</p>\n)}\n```\n\n\u9077\u79fb\u5f8c\u306f\u753b\u9762\u306b\u6cbf\u3063\u3066\u30c6\u30b9\u30c8\u7528\u306e\u60c5\u5831\u3092\u9069\u5b9c\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044\u3002\u9014\u4e2dStripe\u30a2\u30ab\u30a6\u30f3\u30c8\u3067\u30ed\u30b0\u30a4\u30f3\u3059\u308b\u30b7\u30fc\u30f3\u304c\u3042\u308b\u306e\u3067\u65e2\u5b58\u306eStripe\u30a2\u30ab\u30a6\u30f3\u30c8\u3067\u30ed\u30b0\u30a4\u30f3\u3057\u3066\u304f\u3060\u3055\u3044\u3002\u5b9f\u969b\u306e\u30e6\u30fc\u30b6\u30fc\u306f\u3053\u3053\u3067Stripe\u30a2\u30ab\u30a6\u30f3\u30c8\u3092\u4f5c\u6210\u3059\u308b\u3053\u3068\u306b\u306a\u308a\u307e\u3059\u3002\n\n\u96fb\u8a71\u756a\u53f7\u306f `0000000000` \u3092\u4f7f\u7528\u3057\u3066\u304f\u3060\u3055\u3044\u3002"},6470:function(e,n,t){"use strict";t.r(n),n.default=":::warning\n[Node.js](https://nodejs.org/ja/)\u304c\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3055\u308c\u3066\u3044\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\n:::\n\n\u30bf\u30fc\u30df\u30ca\u30eb\u3067\u4ee5\u4e0b\u306e\u30b3\u30de\u30f3\u30c9\u3092\u5b9f\u884c\u3057\u3066Next.js\u306e\u30a2\u30d7\u30ea\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n\n```bash:\u30bf\u30fc\u30df\u30ca\u30eb\nnpx create-next-app@latest --typescript\n```\n\n[\u516c\u5f0f\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8](https://nextjs.org/docs/getting-started#setup)"},2994:function(e,n,t){"use strict";t.r(n),n.default=":::info\n\u4e8b\u524d\u306b\u300c[\u78ba\u8a8d\u60c5\u5831\u5165\u529b\u7528\u30ea\u30f3\u30af\u3068\u30c8\u30ea\u30ac\u30fc\u95a2\u6570\u3092\u4f5c\u6210](?id=firebase-required-verification-information)\u300d\u3092\u5b8c\u4e86\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n:::\n\nStripe\u30c0\u30c3\u30b7\u30e5\u30dc\u30fc\u30c9\u304b\u3089Webhook\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\u4ee5\u4e0b\u306e\u30a4\u30d9\u30f3\u30c8\u3092\u8cfc\u8aad\u3057\u3066\u304f\u3060\u3055\u3044\u3001\n\n- account.updated\n- checkout.session.completed\n\n\u4f5c\u6210\u304c\u7d42\u308f\u3063\u305f\u3089Webhook\u4f5c\u6210\u5f8c\u306b\u751f\u6210\u3055\u308c\u308b\u7f72\u540d\u30b7\u30fc\u30af\u30ec\u30c3\u30c8\u3092[\u30c8\u30ea\u30ac\u30fc\u95a2\u6570](?id=firebase-required-verification-information) \u306e\u7f72\u540d\u30b7\u30fc\u30af\u30ec\u30c3\u30c8\u306b\u53cd\u6620\u3057\u3066\u518d\u30c7\u30d7\u30ed\u30a4\u3057\u3066\u304f\u3060\u3055\u3044\u3002"},7415:function(e,n,t){"use strict";t.r(n),n.default="[Connect \u306e\u8a2d\u5b9a\u30da\u30fc\u30b8](https://dashboard.stripe.com/account/applications/settings) \u3067\u4ee5\u4e0b\u306e\u8a2d\u5b9a\u3092\u884c\u3044\u307e\u3059\u3002\n\n- \u30d6\u30e9\u30f3\u30c9\u306e\u30bf\u30a4\u30c8\u30eb\n- \u30d6\u30e9\u30f3\u30c9\u306e\u30a2\u30a4\u30b3\u30f3\n- \u30ea\u30c0\u30a4\u30ec\u30af\u30c8URL: `localhost:3000`\u3092\u6307\u5b9a\n  \n\u3053\u306e\u8a2d\u5b9a\u3092\u884c\u308f\u306a\u3044\u3068**Connect \u304c\u6a5f\u80fd\u3057\u307e\u305b\u3093\u3002**"},9613:function(e,n,t){"use strict";t.r(n),n.default="[Stripe](https://stripe.com/jp)\u3067\u30a2\u30ab\u30a6\u30f3\u30c8\u3092\u4f5c\u6210\u3057\u307e\u3057\u3087\u3046\u3002"},9754:function(e,n,t){"use strict";t.r(n),n.default="[\u5236\u9650\u4ed8\u304dAPI\u30ad\u30fc](https://stripe.com/docs/keys#limit-access)\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\u8a2d\u5b9a\u9805\u76ee\u306f\u4ee5\u4e0b\u3067\u3059\u3002\n\n| \u6a29\u9650     | \u5bfe\u8c61                                          |\n| -------- | --------------------------------------------- |\n| \u66f8\u304d\u8fbc\u307f | Customers, Checkout Sessions, Customer portal |\n| \u8aad\u307f\u8fbc\u307f | Subscriptions, Plans                          |\n\n[Run Payments with Stripe: README](https://github.com/stripe/stripe-firebase-extensions/blob/master/firestore-stripe-payments/PREINSTALL.md#additional-setup)"},7337:function(e,n,t){"use strict";t.r(n),n.default="[\u5546\u54c1\u3068\u4fa1\u683c\u3092\u4f5c\u6210](https://stripe.com/docs/billing/manage-prices)\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\n\u30e1\u30bf\u30c7\u30fc\u30bf\u306b `firebaseRole` \u3068\u3044\u3046\u30ad\u30fc\u3067\u5024\u3092\u767b\u9332\u3059\u308b\u3053\u3068\u3067\u30b5\u30d6\u30b9\u30af\u30ea\u30d7\u30b7\u30e7\u30f3\u306b\u52a0\u5165\u4e2d\u306bFirebase\u306e\u8a8d\u8a3c\u30e6\u30fc\u30b6\u30fc\u306b `stripeRole` \u3068\u3044\u3046\u30ad\u30fc\u3067[\u30ab\u30b9\u30bf\u30e0\u30af\u30ec\u30fc\u30e0](https://firebase.google.cn/docs/auth/admin/custom-claims?hl=ja)\u304c\u4ed8\u4e0e\u3055\u308c\u307e\u3059\u3002\u30ab\u30b9\u30bf\u30e0\u30af\u30ec\u30fc\u30e0\u306e\u5024\u3092\u4f7f\u3063\u3066\u8868\u793a\u3059\u308b\u30b3\u30f3\u30c6\u30f3\u30c4\u3084\u6a5f\u80fd\u306e\u5236\u9650\u3092\u5236\u5fa1\u3057\u307e\u3059\u3002\n\n[\u30b5\u30d6\u30b9\u30af\u30ea\u30d7\u30b7\u30e7\u30f3\u306e\u30a2\u30c3\u30d7\u30bb\u30eb](https://stripe.com/docs/payments/checkout/upsells)\u3092\u4f7f\u3046\u3068\u9577\u671f\u30d7\u30e9\u30f3\u306b\u30a2\u30c3\u30d7\u30b0\u30ec\u30fc\u30c9\u3059\u308b\u305f\u3081\u306e\u30aa\u30d7\u30b7\u30e7\u30f3\u3092\u9867\u5ba2\u306b\u63d0\u793a\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002"},1251:function(e,n,t){"use strict";t.r(n),n.default="[\u5546\u54c1\u3068\u4fa1\u683c\u3092\u4f5c\u6210](https://stripe.com/docs/billing/manage-prices)\u3057\u3066\u304f\u3060\u3055\u3044\u3002Stripe\u306f\u5546\u54c1\u306e\u4e0b\u306b\u8907\u6570\u306e\u4fa1\u683c\u304c\u7d10\u3065\u304f\u69cb\u9020\u306b\u306a\u308a\u307e\u3059\u3002\n\n\u4fa1\u683c\u306e\u8aac\u660e\u306f\u672c\u6765\u30e6\u30fc\u30b6\u30fc\u753b\u9762\u306b\u8868\u793a\u3055\u308c\u307e\u305b\u3093\u304c\u3001\u4eca\u56de\u306e\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb\u3067\u306f\u3053\u306e\u60c5\u5831\u3092\u753b\u9762\u3067\u8868\u793a\u3055\u305b\u3066\u3044\u307e\u3059\u3002"},2328:function(e,n,t){"use strict";t.r(n),n.default="[\u7a0e\u7387\u3092\u4f5c\u6210](https://stripe.com/docs/billing/taxes/tax-rates#%E7%A8%8E%E7%8E%87%E3%82%92%E4%BD%9C%E6%88%90%E3%81%99%E3%82%8B)\u3057\u3066\u304f\u3060\u3055\u3044\u3002\u81ea\u52d5\u7684\u306b\u7a0e\u7387\u3092\u8a2d\u5b9a\u3057\u305f\u3044\u5834\u5408[Stripe Tax(\u6709\u6599)](https://stripe.com/docs/tax/set-up)\u3092\u4f7f\u3046\u3053\u3068\u3082\u3067\u304d\u307e\u3059\u3002\n\n\u73fe\u5728\u306e\u65e5\u672c\u3067\u306f\u7a0e\u629c\u304d\u4fa1\u683c\u306e\u307f\u306e\u8868\u8a18\u304c\u7981\u6b62\u3055\u308c\u3066\u3044\u307e\u3059\u3002\u5185\u7a0e\u306b\u3059\u308b\u3053\u3068\u3067\u753b\u9762\u8868\u793a\u3084\u6c7a\u6e08\u6642\u306e\u4f53\u9a13\u306b\u4e00\u8cab\u6027\u3092\u6301\u305f\u305b\u3084\u3059\u304f\u306a\u308b\u305f\u3081\u3001**\u5185\u7a0e**\u306e\u9078\u629e\u3092\u63a8\u5968\u3057\u307e\u3059\u3002"},1018:function(e,n,t){"use strict";t.r(n),n.default="Stripe\u30c0\u30c3\u30b7\u30e5\u30dc\u30fc\u30c9\u304b\u3089Webhook\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002Webhook\u306eURL\u306fFirebase\u30b3\u30f3\u30bd\u30fc\u30eb\u306e\u62e1\u5f35\u6a5f\u80fd\u7ba1\u7406\u753b\u9762\u306b\u3042\u308b[[\u3053\u306e\u62e1\u5f35\u6a5f\u80fd\u306e\u52d5\u4f5c]](https://console.firebase.google.com/project/_/extensions/instances/firestore-stripe-payments?tab=details)\u306b\u8a18\u8f09\u3055\u308c\u3066\u3044\u307e\u3059\u3002\n\n\u53d7\u3051\u53d6\u308b\u30a4\u30d9\u30f3\u30c8\u306f\u4ee5\u4e0b\u3092\u8a2d\u5b9a\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\n- product.created\n- product.updated\n- product.deleted\n- price.created\n- price.updated\n- price.deleted\n- checkout.session.completed\n- customer.subscription.created\n- customer.subscription.updated\n- customer.subscription.deleted\n- payment_intent.processing\n- payment_intent.succeeded\n- payment_intent.canceled\n- payment_intent.payment_failed\n- tax_rate.created (optional)\n- tax_rate.updated (optional)\n\n\u8acb\u6c42\u66f8\u60c5\u5831\u3092Firestore\u306b\u540c\u671f\u3057\u305f\u3044\u5834\u5408\u4ee5\u4e0b\u3082\u8a2d\u5b9a\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\n- invoice.paid\n- invoice.payment_succeeded\n- invoice.payment_failed\n- invoice.upcoming\n- invoice.marked_uncollectible\n- invoice.payment_action_required\n\nWebhook\u4f5c\u6210\u5f8c\u306b\u751f\u6210\u3055\u308c\u308b\u7f72\u540d\u30b7\u30fc\u30af\u30ec\u30c3\u30c8\u306f\u62e1\u5f35\u6a5f\u80fd\u3067\u4f7f\u7528\u3057\u307e\u3059\u3002\n\n![](/docs/images/2022-01-22-14-42-02.png)\n\n[Run Payments with Stripe: README](https://github.com/stripe/stripe-firebase-extensions/blob/master/firestore-stripe-payments/POSTINSTALL.md#configure-stripe-webhooks)"},2487:function(e,n,t){"use strict";t.r(n),n.default="Stripe\u30c0\u30c3\u30b7\u30e5\u30dc\u30fc\u30c9\u304b\u3089[\u30ab\u30b9\u30bf\u30de\u30fc\u30dd\u30fc\u30bf\u30eb\u3092\u30ab\u30b9\u30bf\u30de\u30a4\u30ba](https://stripe.com/docs/billing/subscriptions/integrating-customer-portal)\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\n\u30ab\u30b9\u30bf\u30de\u30fc\u30dd\u30fc\u30bf\u30eb\u3092\u6709\u52b9\u306b\u3059\u308b\u305f\u3081\u306b\u5229\u7528\u898f\u7d04\u3068\u30d7\u30e9\u30a4\u30d0\u30b7\u30fc\u30dd\u30ea\u30b7\u30fc\u306eURL\u3092\u8a2d\u5b9a\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\u958b\u767a\u74b0\u5883\u3067\u306f\u30c0\u30df\u30fc\u306eURL\u3067\u554f\u984c\u3042\u308a\u307e\u305b\u3093\u304c\u3001\u672c\u756a\u74b0\u5883\u3067\u306f\u5b9f\u969b\u306e\u5229\u7528\u898f\u7d04\u3068\u30d7\u30e9\u30a4\u30d0\u30b7\u30fc\u30dd\u30ea\u30b7\u30fc\u30da\u30fc\u30b8\u306eURL\u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n\n\u30ab\u30b9\u30bf\u30de\u30fc\u304c\u30ab\u30fc\u30c9\u60c5\u5831\u3084\u30b5\u30d6\u30b9\u30af\u30ea\u30d7\u30b7\u30e7\u30f3\u3092\u7ba1\u7406\u3067\u304d\u308b\u3088\u3046\u95a2\u9023\u9805\u76ee\u3092\u6709\u52b9\u306b\u3057\u3066\u304a\u304d\u307e\u3057\u3087\u3046\u3002"},1804:function(e,n,t){"use strict";t.r(n),n.default="Stripe\u30c0\u30c3\u30b7\u30e5\u30dc\u30fc\u30c9\u304b\u3089[\u30ab\u30b9\u30bf\u30de\u30fc\u30dd\u30fc\u30bf\u30eb\u3092\u30ab\u30b9\u30bf\u30de\u30a4\u30ba](https://stripe.com/docs/billing/subscriptions/integrating-customer-portal)\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\n\u30ab\u30b9\u30bf\u30de\u30fc\u30dd\u30fc\u30bf\u30eb\u3092\u6709\u52b9\u306b\u3059\u308b\u305f\u3081\u306b\u5229\u7528\u898f\u7d04\u3068\u30d7\u30e9\u30a4\u30d0\u30b7\u30fc\u30dd\u30ea\u30b7\u30fc\u306eURL\u3092\u8a2d\u5b9a\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\u958b\u767a\u74b0\u5883\u3067\u306f\u30c0\u30df\u30fc\u306eURL\u3067\u554f\u984c\u3042\u308a\u307e\u305b\u3093\u304c\u3001\u672c\u756a\u74b0\u5883\u3067\u306f\u5b9f\u969b\u306e\u5229\u7528\u898f\u7d04\u3068\u30d7\u30e9\u30a4\u30d0\u30b7\u30fc\u30dd\u30ea\u30b7\u30fc\u30da\u30fc\u30b8\u306eURL\u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n\n\u9867\u5ba2\u304c\u30ab\u30fc\u30c9\u60c5\u5831\u3092\u7ba1\u7406\u3067\u304d\u308b\u3088\u3046\u30ab\u30fc\u30c9\u60c5\u5831\u306e\u7ba1\u7406\u6a5f\u80fd\u3092\u6709\u52b9\u306b\u3057\u3066\u304a\u304d\u307e\u3057\u3087\u3046\u3002"}}]);